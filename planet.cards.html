<!DOCTYPE html>
<html>
  <head>
   <meta charset='utf-8'>
   <meta name='generator' content='Pluto 1.5.2 on Ruby 2.7.0 (2019-12-25) [x86_64-linux]'>
   <title>Planet Gentoo (test)</title>

   <link rel='stylesheet' type='text/css' href='css/font-awesome.css'>
   <link rel='stylesheet' type='text/css' href='css/blank.cards.css'>

  <!-- fix: use script_tag  rails-style ??? -->
  <script src='js/jquery-2.0.3.min.js'></script>
  <script src='js/blank.js'></script>

  
  
  </head>
  <body>


<div id='opts'>
  <div style='width: 100%; text-align: right;'>
   <img src='i/view-headlines.png' id='show-headlines' title='Show Headlines Only' width='24' height='24'>
   <img src='i/view-snippets.png' id='show-snippets'    title='Show Snippets' width='24' height='24'>
   <img src='i/view-standard.png' id='show-fulltext'    title='Show Full Text' width='24' height='24'>
  </div>
  <div style='width: 100%; text-align: right;'>
    Style | 
      <a href='planet.html'>Standard</a> &bull;
      <a href='planet.cards.html'>Cards</a>    
  </div>
</div>


<h1>
  Planet Gentoo (test)
  <span class='small'>
  Last Update:
   
  </span>
</h1>


<!-- use a table w/ two colums -->


<table>
  <colgroup>
    <col width='50%'>
    <col width='50%'>
  </colgroup>
<tr>



<td valign='top'>
  <!-- start new column -->

  



<article class='item'>

<h4 class='feed-title'>
  <span class='feed-title'>
    <a href='http://www.gentoo.org/rdf/en/gentoo-news.rdf'>Gentoo News</a>
  </span>
  <span class='item-published'>
     - 
      <!-- fix/todo: show year if not current year
           e.g. use "%b %d, '%y"
         -->
     Jan 03
  </span>
</h4>


<h3 class='item-title'>
  <i class='icon-caret-down item-collapse item-close item-opened'></i>
  <i class='icon-caret-right item-expand item-open item-closed'></i>
  <span class='item-title'>
    <a href='https://www.gentoo.org/news/2020/01/03/gentoo-fosdem-2020.html'>FOSDEM 2020</a>
   </span>
</h3>

<div class='item-body'>
  
<div class='item-snippet'>
<!-- use 'smarter' algorithm for cutoff snippet text
   note: summary goes first; than try content -->

  <p>
  ♦
</p>

<p>It’s FOSDEM time again! Join us at Université libre de Bruxelles,
Campus du Solbosch, in Brussels, Belgium. This year’s FOSDEM 2020 will 
be held on February 1st and 2nd.</p>

<p>Our developers will be happy to greet all open source enthusiasts at 
our Gentoo stand in building K where
we will also celebrate 20 years compiling!
Visit this year’s wiki page to see
who’s coming.</p>


 <span class='item-time-ago-in-words'>
 26 days ago
 </span>  
</div>

<div class='item-content item-summary'>

<!-- todo: use sanitize or simplify or whitelist
   - todo/fix: check why summary can be nil/null
   note: content goes first; than try summary
 -->

  <p>
  ♦
</p>

<p>It’s FOSDEM time again! Join us at Université libre de Bruxelles,
Campus du Solbosch, in Brussels, Belgium. This year’s FOSDEM 2020 will 
be held on February 1st and 2nd.</p>

<p>Our developers will be happy to greet all open source enthusiasts at 
our Gentoo stand in building K where
we will also celebrate 20 years compiling!
Visit this year’s wiki page to see
who’s coming.</p>


 <span class='item-time-ago-in-words'>
 26 days ago
 </span>  
  
</div>

</div> <!-- item-body -->
</article><!-- item -->


  



<article class='item'>

<h4 class='feed-title'>
  <span class='feed-title'>
    <a href='http://blogs.gentoo.org/mgorny/'>Michał Górny</a>
  </span>
  <span class='item-published'>
     - 
      <!-- fix/todo: show year if not current year
           e.g. use "%b %d, '%y"
         -->
     Dec 24
  </span>
</h4>


<h3 class='item-title'>
  <i class='icon-caret-down item-collapse item-close item-opened'></i>
  <i class='icon-caret-right item-expand item-open item-closed'></i>
  <span class='item-title'>
    <a href='https://blogs.gentoo.org/mgorny/2019/12/24/handling-pep-517-pyproject-toml-packages-in-gentoo/'>Handling PEP 517 (pyproject.toml) packages in Gentoo</a>
   </span>
</h3>

<div class='item-body'>
  
<div class='item-snippet'>
<!-- use 'smarter' algorithm for cutoff snippet text
   note: summary goes first; than try content -->

  So far, the&#160;majority of&#160;Python packages have either used distutils, or&#160;a&#160;build system built upon it. Most frequently, this was setuptools. All those solutions provided a&#160;setup.py script with a&#160;semi-standard interface, and&#160;we were able to&#160;handle them reliably within distutils-r1.eclass. PEP 517 changed that. Instead of&#160;a&#160;setup script, packages now on


 <span class='item-time-ago-in-words'>
 1 months ago
 </span>  
</div>

<div class='item-content item-summary'>

<!-- todo: use sanitize or simplify or whitelist
   - todo/fix: check why summary can be nil/null
   note: content goes first; than try summary
 -->

  <p>So far, the&nbsp;majority of&nbsp;Python packages have either used distutils, or&nbsp;a&nbsp;build system built upon it.  Most frequently, this was setuptools.  All those solutions provided a&nbsp;<code>setup.py</code> script with a&nbsp;semi-standard interface, and&nbsp;we were able to&nbsp;handle them reliably within <code>distutils-r1.eclass</code>.  PEP 517 changed that.</p>
<p>Instead of&nbsp;a&nbsp;setup script, packages now only need to&nbsp;supply a&nbsp;declarative project information in&nbsp;<code>pyproject.toml</code> file (fun fact: TOML parser is not&nbsp;even part of&nbsp;Python stdlib yet).  The&nbsp;build system used is specified as&nbsp;a&nbsp;combination of&nbsp;a&nbsp;package requirement and&nbsp;a&nbsp;backend object to&nbsp;use.  The&nbsp;backends are expected to&nbsp;provide a&nbsp;very narrow API: it&#8217;s limited to&nbsp;building wheel packages and&nbsp;source distribution tarballs.</p>
<p>The&nbsp;new build systems built around this concept are troublesome to&nbsp;Gentoo.  They are more focused on&nbsp;being standalone package managers than build systems.  They lack the&nbsp;APIs matching our needs.  They have large dependency trees, including circular dependencies.  Hence, we&#8217;ve decided to&nbsp;try an&nbsp;alternate route.<br>
<br>
Instead of&nbsp;trying to&nbsp;tame the&nbsp;new build systems, or&nbsp;work around their deficiencies (i.e.&nbsp;by&nbsp;making them build wheel packages, then unpacking and&nbsp;repackaging them), we&#8217;ve explored the&nbsp;possibility of&nbsp;converting the&nbsp;<code>pyproject.toml</code> files into&nbsp;<code>setup.py</code> scripts.  Since the&nbsp;new formats are declarative, this should not be that hard.</p>
<p>We&#8217;ve found poetry-setup project which seemed to&nbsp;have a&nbsp;similar goal.  However, it was already discontinued at&nbsp;the&nbsp;time in&nbsp;favor of&nbsp;dephell.  The&nbsp;latter project looked pretty powerful but&nbsp;the&nbsp;name was pretty ominous.  We did not need most of&nbsp;the&nbsp;functions, and&nbsp;it was hell to&nbsp;package.</p>
<p>Finally, I&#8217;ve managed to&nbsp;dedicate some time into building an&nbsp;in-house solution instead.  pyproject2setuppy is a&nbsp;small-ish (&lt;100 SLOC) <code>pyproject.toml</code>-to-setuptools adapter which allows us to&nbsp;run flit- or&nbsp;poetry-based projects as&nbsp;if&nbsp;they used regular distutils.  While it&#8217;s quite limited, it&#8217;s good enough to&nbsp;build and&nbsp;install the&nbsp;packages that we needed to&nbsp;deal with so far.</p>
<p>The&nbsp;design is quite simple — it reads <code>pyproject.toml</code> and&nbsp;calls setuptools&#8217; <code>setup()</code> function with the&nbsp;metadata read.  As&nbsp;such, the&nbsp;package can even be&nbsp;used to&nbsp;provide a&nbsp;backwards-compatible <code>setup.py</code> script in&nbsp;other packages.  In&nbsp;fact, this is how its own <code>setup.py</code> works — it carries flit-compatible <code>pyproject.toml</code> and&nbsp;uses itself to&nbsp;install itself via&nbsp;setuptools.</p>
<p><code>dev-python/pyproject2setuppy</code> is already packaged in&nbsp;Gentoo.  I&#8217;ve sent eclass patches to&nbsp;easily integrate it into distutils-r1.  Once they are merged, installing <code>pyproject.toml</code> packages should be as&nbsp;simple as&nbsp;adding the&nbsp;following declaration into&nbsp;ebuilds:</p>
<pre><code>DISTUTILS_USE_SETUPTOOLS=pyproject.toml
</code></pre>
<p>This should make things easier both for us (as&nbsp;it saves us from&nbsp;having to&nbsp;hurriedly add new build systems and&nbsp;their NIH dependencies) and&nbsp;for users who will not have to&nbsp;suffer from more circular dependencies in&nbsp;the&nbsp;Python world.  It may also help some upstream projects to&nbsp;maintain backwards compatibility while migrating to&nbsp;new build systems.</p>


 <span class='item-time-ago-in-words'>
 1 months ago
 </span>  
  
</div>

</div> <!-- item-body -->
</article><!-- item -->


  



<article class='item'>

<h4 class='feed-title'>
  <span class='feed-title'>
    <a href='http://blogs.gentoo.org/mgorny/'>Michał Górny</a>
  </span>
  <span class='item-published'>
     - 
      <!-- fix/todo: show year if not current year
           e.g. use "%b %d, '%y"
         -->
     Dec 12
  </span>
</h4>


<h3 class='item-title'>
  <i class='icon-caret-down item-collapse item-close item-opened'></i>
  <i class='icon-caret-right item-expand item-open item-closed'></i>
  <span class='item-title'>
    <a href='https://blogs.gentoo.org/mgorny/2019/12/12/a-better-ebuild-workflow-with-pure-git-and-pkgcheck/'>A better ebuild workflow with pure git and pkgcheck</a>
   </span>
</h3>

<div class='item-body'>
  
<div class='item-snippet'>
<!-- use 'smarter' algorithm for cutoff snippet text
   note: summary goes first; than try content -->

  Many developers today continue using repoman commit as&#160;their primary way of&#160;committing to&#160;Gentoo. While this tool was quite helpful, if&#160;not&#160;indispensable in&#160;times of&#160;CVS, today it&#8217;s a&#160;burden. The&#160;workflow using a&#160;single serial tool to&#160;check your packages and&#160;commit to&#160;them is not&#160;very efficient. Not only it wastes your time


 <span class='item-time-ago-in-words'>
 2 months ago
 </span>  
</div>

<div class='item-content item-summary'>

<!-- todo: use sanitize or simplify or whitelist
   - todo/fix: check why summary can be nil/null
   note: content goes first; than try summary
 -->

  <p>Many developers today continue using repoman commit as&nbsp;their primary way of&nbsp;committing to&nbsp;Gentoo.  While this tool was quite helpful, if&nbsp;not&nbsp;indispensable in&nbsp;times of&nbsp;CVS, today it&#8217;s a&nbsp;burden.  The&nbsp;workflow using a&nbsp;single serial tool to&nbsp;check your packages and&nbsp;commit to&nbsp;them is not&nbsp;very efficient.  Not only it wastes your time and&nbsp;slows you down — it discourages you from splitting your changes into more atomic commits.</p>
<p>Upon hearing the&nbsp;pkgcheck advocacy, many developers ask whether it can commit for you.  It won&#8217;t do that, that&#8217;s not its purpose.  Not only it&#8217;s waste of&nbsp;time to&nbsp;implement that — it would actually make it a&nbsp;worse tool.  With its parallel engine pkgcheck really shines when dealing with&nbsp;multiple packages — forcing it to&nbsp;work on&nbsp;one package is a&nbsp;waste of&nbsp;its potential.</p>
<p>Rather than trying to&nbsp;proliferate your bad old habits, you should learn how to&nbsp;use git and&nbsp;pkgcheck efficiently.  This post aims to&nbsp;give you a&nbsp;few advices.</p>
<p></p>
pkgcheck after committing
<p>Repoman was built under the&nbsp;assumption that checks should be&nbsp;done prior to&nbsp;committing.  That is understandable when you&#8217;re working on&nbsp;a&nbsp;‘live’ repository as&nbsp;the&nbsp;ones used by&nbsp;CVS or&nbsp;Subversion.  However, in&nbsp;case of&nbsp;VCS-es involving staging commits such as&nbsp;Git there is no&nbsp;real difference between checking prior to&nbsp;or&nbsp;post commit.  The&nbsp;most efficient pkgcheck workflow is to&nbsp;check once all changes are committed and&nbsp;you are ready to&nbsp;push.</p>
<p>The&nbsp;most recent version of&nbsp;pkgcheck has a&nbsp;command just for that:</p>
<pre><code>$ pkgcheck scan --commits</code></pre>
<p>Yes, it&#8217;s that simple.  It checks what you&#8217;ve committed compared to&nbsp;origin (note: you&#8217;ll need to&nbsp;have a&nbsp;correct origin remote), and&nbsp;runs scan on&nbsp;all those packages.  Now, if&nbsp;you&#8217;re committing changes to&nbsp;multiple packages (which should be&nbsp;pretty common), the&nbsp;scan is run in&nbsp;parallel to&nbsp;utilize your CPU power better.</p>
<p>You might say: but&nbsp;repoman ensures that my commit message is neat these days!  Guess what.  The&nbsp;--commits option does exactly that — it raises warnings if your commit message is bad.  Admittedly, it only checks summary line at&nbsp;the&nbsp;moment but that&#8217;s something that can (and&nbsp;will) be&nbsp;improved easily.</p>
<p>And I&#8217;ve forgotten the most cool thing of all: pkgcheck also reports if you accidentally remove the newest ebuild with stable keywords on given arch!</p>
<p>One more tip.  You can use the&nbsp;following option to&nbsp;include full live verification of&nbsp;URLs:</p>
<pre><code>$ pkgcheck scan --net --commits</code></pre>
<p>Again, this is a&nbsp;feature missing entirely from&nbsp;repoman.</p>
pkgcommit to&nbsp;ease committing to&nbsp;ebuilds
<p>While the&nbsp;majority of&nbsp;repoman&#8217;s VCS support is&nbsp;superficial or&nbsp;better implemented elsewhere, there&#8217;s one killer feature worth keeping: automatically prepending the&nbsp;package name to the&nbsp;summary line.  Since that is a&nbsp;really trivial thing, I&#8217;ve reimplemented it in&nbsp;a&nbsp;few lines of&nbsp;bash as&nbsp;pkgcommit.</p>
<p>When run in&nbsp;a&nbsp;package directory, it runs an editor with pre-filled commit message template to&nbsp;let you type it in, then passes it along with its own arguments to git.  Usually, I use it as (I like to be&nbsp;explicit about signoffs and&nbsp;signing, you can make .git/config take care of&nbsp;it):</p>
<pre><code>$ pkgcommit -sS .</code></pre>
<p>Its extra feature is that it processes -m option and&nbsp;lets you skip the&nbsp;editor for&nbsp;simple messages:</p>
<pre><code>$ pkgcommit -sS . -m 'Bump to 1.2.3'</code></pre>
<p>Note that it does not go out of&nbsp;its way to figure out what to&nbsp;commit.  You need to&nbsp;either stage changes yourself via&nbsp;git add, or&nbsp;pass appropriate paths to&nbsp;the&nbsp;command.  What&#8217;s important is that it does not&nbsp;limit you to&nbsp;committing to&nbsp;one directory — you can e.g. include some profile changes easily.</p>
<p>You&#8217;ll also need pkg script from the&nbsp;same repository.  Or&nbsp;you just install the&nbsp;whole bundle of&nbsp;app-portage/mgorny-dev-scripts.</p>
Amending commits via&nbsp;fixups
<p>Most of&nbsp;you know probably know that you can update commits via&nbsp;git commit --amend.  However, that&#8217;s useful only for&nbsp;editing the&nbsp;most recent commit.  You can also use interactive rebase to&nbsp;choose specific commits for&nbsp;editing, and&nbsp;then amend them.  Yet, usually there&#8217;s a&nbsp;much more convenient way of&nbsp;doing that.</p>
<p>In&nbsp;order to&nbsp;commit a&nbsp;fixup to a&nbsp;particular past commit, use:</p>
<pre><code>$ git commit --fixup OLD_COMMIT_ID</code></pre>
<p>This will create a&nbsp;specially titled commit that will be automatically picked up and&nbsp;ordered by&nbsp;the&nbsp;interactive rebase:</p>
<pre><code>$ git rebase -i -S origin</code></pre>
<p>Again, I have a&nbsp;tool of&nbsp;greater convenience.  Frequently, I just want to update the&nbsp;latest commit to&nbsp;a&nbsp;particular package (directory).  git-fixup does exactly that — it finds the&nbsp;identifier of&nbsp;the&nbsp;latest commit to a&nbsp;particular file/directory (or&nbsp;the&nbsp;current directory when no&nbsp;parameter is&nbsp;given) and&nbsp;commits a&nbsp;fixup to that:</p>
<pre><code>$ git-fixup .</code></pre>
<p>Note that if&nbsp;you try to&nbsp;push fixups into the&nbsp;repository, nothing will stop you.  This is one of&nbsp;the&nbsp;reasons that I don&#8217;t enable signoffs and&nbsp;signing on&nbsp;all commits by&nbsp;default.  This way, if&nbsp;I&nbsp;forget to&nbsp;rebase my fixups, the&nbsp;git hook will reject them as&nbsp;lacking signoff and/or&nbsp;signature.</p>
<p>Again, it is part of&nbsp;app-portage/mgorny-dev-scripts.</p>
Interactive rebase to the&nbsp;rescue
<p>When trivial tools are no&nbsp;longer sufficient, interactive rebase is probably one of&nbsp;the&nbsp;best tools for&nbsp;editing your commits.  Start by&nbsp;initiating it for&nbsp;all commits since the&nbsp;last push:</p>
<pre><code>$ git rebase -i -S origin</code></pre>
<p>It will bring your editor with a&nbsp;list of&nbsp;all commits.  Using this list, you can do a&nbsp;lot: reorder commits, drop them, reword their commit messages, use squash or&nbsp;fixup to&nbsp;merge them into other commits, and&nbsp;finally: edit them (open for&nbsp;amending).</p>
<p>The&nbsp;interactive rebase is&nbsp;probably the&nbsp;most powerful porcelain git command.  I&#8217;ve personally found the&nbsp;immediate tips given by&nbsp;git good enough but&nbsp;I&nbsp;realize that many people find it hard nevertheless.  Since it&#8217;s not my goal here to&nbsp;provide detailed instructions on&nbsp;using git, I&#8217;m going to&nbsp;suggest looking online for&nbsp;tutorials and&nbsp;guides.  The&nbsp;Rewriting History section of&nbsp;the&nbsp;Git Book also has a&nbsp;few examples.</p>
Before pushing: git log
<p>git log seems to be&nbsp;one of&nbsp;the&nbsp;most underappreciated pre-push tools.  However, it can be of&nbsp;great service to&nbsp;you.  When run prior to&nbsp;pushing, it can help you verify that what you&#8217;re pushing is&nbsp;actually what you&#8217;ve meant to&nbsp;push.</p>
<pre><code>$ git log --stat</code></pre>
<p>will list all staged commits along with a&nbsp;pretty summary of&nbsp;affected files.  This can help you notice that you&#8217;ve forgotten to&nbsp;git add a&nbsp;patch, or&nbsp;that you&#8217;ve accidentally committed some extraneous change, or that you&#8217;ve just mixed changes from two commits.</p>
<p>Of course, you can go even further and&nbsp;take a&nbsp;look at&nbsp;the&nbsp;changes in&nbsp;patch form:</p>
<pre><code>$ git log -p</code></pre>
<p>While I&nbsp;realize this is nothing new or&nbsp;surprising to&nbsp;you, sometimes it&#8217;s worthwhile to&nbsp;reiterate the&nbsp;basics in&nbsp;a&nbsp;different context to&nbsp;make you realize something obvious.</p>


 <span class='item-time-ago-in-words'>
 2 months ago
 </span>  
  
</div>

</div> <!-- item-body -->
</article><!-- item -->


  



<article class='item'>

<h4 class='feed-title'>
  <span class='feed-title'>
    <a href='http://blogs.gentoo.org/mgorny/'>Michał Górny</a>
  </span>
  <span class='item-published'>
     - 
      <!-- fix/todo: show year if not current year
           e.g. use "%b %d, '%y"
         -->
     Oct 13
  </span>
</h4>


<h3 class='item-title'>
  <i class='icon-caret-down item-collapse item-close item-opened'></i>
  <i class='icon-caret-right item-expand item-open item-closed'></i>
  <span class='item-title'>
    <a href='https://blogs.gentoo.org/mgorny/2019/10/13/improving-distfile-mirror-structure/'>Improving distfile mirror structure</a>
   </span>
</h3>

<div class='item-body'>
  
<div class='item-snippet'>
<!-- use 'smarter' algorithm for cutoff snippet text
   note: summary goes first; than try content -->

  The&#160;Gentoo distfile mirror network is essential in&#160;distributing sources to&#160;our users. It&#160;offloads upstream download locations, improves throughput and&#160;reliability, guarantees distfile persistency. The&#160;current structure of&#160;distfile mirrors dates back to&#160;2002. It&#160;might have worked well back when we mirrored around 2500 files but&#160;it proved not&#160;to&


 <span class='item-time-ago-in-words'>
 4 months ago
 </span>  
</div>

<div class='item-content item-summary'>

<!-- todo: use sanitize or simplify or whitelist
   - todo/fix: check why summary can be nil/null
   note: content goes first; than try summary
 -->

  <p>The&nbsp;Gentoo distfile mirror network is essential in&nbsp;distributing sources to&nbsp;our users.  It&nbsp;offloads upstream download locations, improves throughput and&nbsp;reliability, guarantees distfile persistency.</p>
<p>The&nbsp;current structure of&nbsp;distfile mirrors dates back to&nbsp;2002.  It&nbsp;might have worked well back when we mirrored around 2500 files but&nbsp;it proved not&nbsp;to&nbsp;scale well.  Today, mirrors hold almost 70&nbsp;000 files, and&nbsp;this number has been causing problems for mirror admins.</p>
<p>The&nbsp;most recent discussion on&nbsp;restructuring mirrors started in&nbsp;January&nbsp;2015.  I&nbsp;have started the&nbsp;preliminary research in&nbsp;January&nbsp;2017, and&nbsp;it resulted in&nbsp;GLEP&nbsp;75 being created in&nbsp;January&nbsp;2018.  With the&nbsp;actual implementation effort starting in&nbsp;October&nbsp;2019, I&#8217;d like to&nbsp;summarize all the&nbsp;data and&nbsp;update it with&nbsp;fresh statistics.</p>
<p>Continue reading</p>


 <span class='item-time-ago-in-words'>
 4 months ago
 </span>  
  
</div>

</div> <!-- item-body -->
</article><!-- item -->


  



<article class='item'>

<h4 class='feed-title'>
  <span class='feed-title'>
    <a href='https://blog.lordvan.com/blog/'>Thomas Raschbacher</a>
  </span>
  <span class='item-published'>
     - 
      <!-- fix/todo: show year if not current year
           e.g. use "%b %d, '%y"
         -->
     Sep 30
  </span>
</h4>


<h3 class='item-title'>
  <i class='icon-caret-down item-collapse item-close item-opened'></i>
  <i class='icon-caret-right item-expand item-open item-closed'></i>
  <span class='item-title'>
    <a href='https://blog.lordvan.com/blog/network-is-unreachable-error-gentoo-silly-netifrc-configuration-mistake/'>&quot;Network is unreachable&quot; error - Gentoo, silly netifrc configuration mistake</a>
   </span>
</h3>

<div class='item-body'>
  
<div class='item-snippet'>
<!-- use 'smarter' algorithm for cutoff snippet text
   note: summary goes first; than try content -->

  <p>So on a new install I was just sitting there and wondering .. what did I do wrong .. why do I keep getting those errors:</p>
<pre># ping lordvan.com<br>connect: Network is unreachable</pre>
<p>then I realized something when checking the output of r<code>oute -n</code>:</p>
<pre> # route -n<br>Kernel IP routing table<br>Destination     Gateway         Genmask         Flags Metric Ref    Use Iface


 <span class='item-time-ago-in-words'>
 4 months ago
 </span>  
</div>

<div class='item-content item-summary'>

<!-- todo: use sanitize or simplify or whitelist
   - todo/fix: check why summary can be nil/null
   note: content goes first; than try summary
 -->

  <p>So on a new install I was just sitting there and wondering .. what did I do wrong .. why do I keep getting those errors:</p>
<pre># ping lordvan.com<br>connect: Network is unreachable</pre>
<p>then I realized something when checking the output of r<code>oute -n</code>:</p>
<pre> # route -n<br>Kernel IP routing table<br>Destination     Gateway         Genmask         Flags Metric Ref    Use Iface<br>192.168.0.0     0.0.0.0         255.255.255.0   U     0      0        0 enp96s0f0<br>192.168.0.254   0.0.0.0         255.255.255.255 UH    2      0        0 enp96s0f0</pre>
<p>It should be:</p>
<pre> # route -n<br>Kernel IP routing table<br>Destination     Gateway         Genmask         Flags Metric Ref    Use Iface<br>0.0.0.0         192.168.0.254   0.0.0.0         UG    2      0        0 enp96s0f0<br>192.168.0.0     0.0.0.0         255.255.255.0   U     0      0        0 enp96s0f0</pre>
<p>Turns out I had forgotten something quite simple, yet important: add <code>"default via &lt;router IP&gt;"</code> to <code>/etc/conf.d/net</code>.. So after changing it from</p>
<pre>routes_enp96s0f0="192.168.0.254"</pre>
<p>to</p>
<pre>routes_enp96s0f0="default via 192.168.0.254"</pre>
<p>and restarting the interface everything works just fine ;)</p>
<p>Silly mistake, easy fix .. can be a pain to realize what went wrong though .. maybe someone will make the same mistake and find this blog post hopefully to fix it faster than me ;)</p>


 <span class='item-time-ago-in-words'>
 4 months ago
 </span>  
  
</div>

</div> <!-- item-body -->
</article><!-- item -->


  



<article class='item'>

<h4 class='feed-title'>
  <span class='feed-title'>
    <a href='http://z-issue.com/wp/'>Nathan Zachary</a>
  </span>
  <span class='item-published'>
     - 
      <!-- fix/todo: show year if not current year
           e.g. use "%b %d, '%y"
         -->
     Sep 13
  </span>
</h4>


<h3 class='item-title'>
  <i class='icon-caret-down item-collapse item-close item-opened'></i>
  <i class='icon-caret-right item-expand item-open item-closed'></i>
  <span class='item-title'>
    <a href='https://z-issue.com/wp/vim-pulling-in-xorg-dependencies-in-gentoo/'>Vim pulling in xorg dependencies in Gentoo</a>
   </span>
</h3>

<div class='item-body'>
  
<div class='item-snippet'>
<!-- use 'smarter' algorithm for cutoff snippet text
   note: summary goes first; than try content -->

  Today I went to update one of my Gentoo servers, and noticed that it wanted to pull in a bunch of xorg dependencies. This is a simple music server without any type of graphical environment, so I don&#8217;t really want any xorg libraries or other GUI components installed. Looking through the full output, I couldn&#8217;t &#8230; </p><p>Continue reading


 <span class='item-time-ago-in-words'>
 5 months ago
 </span>  
</div>

<div class='item-content item-summary'>

<!-- todo: use sanitize or simplify or whitelist
   - todo/fix: check why summary can be nil/null
   note: content goes first; than try summary
 -->

  <p>Today I went to update one of my Gentoo servers, and noticed that it wanted to pull in a bunch of xorg dependencies.  This is a simple music server without any type of graphical environment, so I don&#8217;t really want any xorg libraries or other GUI components installed.  Looking through the full output, I couldn&#8217;t see a direct reason that these components were now requirements.</p>



<p>To troubleshoot, I started adding packages to /etc/portage/package.mask, starting with cairo (which was the package directly requesting the &#8216;X&#8217; USE flag be enabled).  That didn&#8217;t get me very far as it still just indicated that GTK+ needed to be installed.  After following the dependency chain for a bit, I noticed that something was pulling in libcanberra and found that the default USE flags now include &#8216;sound&#8217; and that vim now had it enabled.  It looks like this USE flag was added between vim-8.1.1486 and vim-8.1.1846.</p>



<p>For my needs, the most straightforward solution was to just remove the &#8216;sound&#8217; USE flag from vim by adding the following to /etc/portage/package.use:</p>



<pre><code># grep vim /etc/portage/package.use 
app-editors/vim -sound</code></pre>


 <span class='item-time-ago-in-words'>
 5 months ago
 </span>  
  
</div>

</div> <!-- item-body -->
</article><!-- item -->


  



<article class='item'>

<h4 class='feed-title'>
  <span class='feed-title'>
    <a href='http://www.gentoo.org/rdf/en/gentoo-news.rdf'>Gentoo News</a>
  </span>
  <span class='item-published'>
     - 
      <!-- fix/todo: show year if not current year
           e.g. use "%b %d, '%y"
         -->
     Aug 11
  </span>
</h4>


<h3 class='item-title'>
  <i class='icon-caret-down item-collapse item-close item-opened'></i>
  <i class='icon-caret-right item-expand item-open item-closed'></i>
  <span class='item-title'>
    <a href='https://www.gentoo.org/news/2019/08/11/arm64stable.html'>AArch64 (arm64) profiles are now stable!</a>
   </span>
</h3>

<div class='item-body'>
  
<div class='item-snippet'>
<!-- use 'smarter' algorithm for cutoff snippet text
   note: summary goes first; than try content -->

  <p>
  ♦
</p>

<p>The ARM64 project is pleased to announce that all ARM64 profiles are now stable.</p>

<p>While our developers and users have contributed significantly in this
accomplishment, we must also thank our Packet sponsor
for their contribution. Providing the Gentoo developer community with access to
bare metal hardware has accelerated progress in achieving the stabilization of
the ARM64 pr


 <span class='item-time-ago-in-words'>
 6 months ago
 </span>  
</div>

<div class='item-content item-summary'>

<!-- todo: use sanitize or simplify or whitelist
   - todo/fix: check why summary can be nil/null
   note: content goes first; than try summary
 -->

  <p>
  ♦
</p>

<p>The ARM64 project is pleased to announce that all ARM64 profiles are now stable.</p>

<p>While our developers and users have contributed significantly in this
accomplishment, we must also thank our Packet sponsor
for their contribution. Providing the Gentoo developer community with access to
bare metal hardware has accelerated progress in achieving the stabilization of
the ARM64 profiles.</p>

<!--more-->

About Packet.com

<p>This access has been kindly provided to Gentoo by bare metal cloud Packet via
their Works on Arm project. Learn more about their commitment to supporting open
source here.</p>

About Gentoo

<p>Gentoo Linux is a free, source-based, rolling
release meta distribution that features a high degree of flexibility and high
performance. It empowers you to make your computer work for you, and offers a
variety of choices at all levels of system configuration.</p>

<p>As a community, Gentoo consists of approximately two hundred developers and
over fifty thousand users globally.</p>


 <span class='item-time-ago-in-words'>
 6 months ago
 </span>  
  
</div>

</div> <!-- item-body -->
</article><!-- item -->


  



<article class='item'>

<h4 class='feed-title'>
  <span class='feed-title'>
    <a href='https://blog.lordvan.com/blog/'>Thomas Raschbacher</a>
  </span>
  <span class='item-published'>
     - 
      <!-- fix/todo: show year if not current year
           e.g. use "%b %d, '%y"
         -->
     Jul 09
  </span>
</h4>


<h3 class='item-title'>
  <i class='icon-caret-down item-collapse item-close item-opened'></i>
  <i class='icon-caret-right item-expand item-open item-closed'></i>
  <span class='item-title'>
    <a href='https://blog.lordvan.com/blog/autoclicker-for-linux/'>Autoclicker for Linux</a>
   </span>
</h3>

<div class='item-body'>
  
<div class='item-snippet'>
<!-- use 'smarter' algorithm for cutoff snippet text
   note: summary goes first; than try content -->

  <p>So I wanted an autoclicker for linux - for one of my browser based games that require a lot of clicking.</p>
<p>Looked around and tried to find something useful, but all i could find was old pages outdated download links,..</p>
<p>In the end I stumbled upon something simple yet immensely more powerful:xdotool (github)  or check out the xdotool website</p>
<p>As an extra bonus it is in the Gentoo


 <span class='item-time-ago-in-words'>
 7 months ago
 </span>  
</div>

<div class='item-content item-summary'>

<!-- todo: use sanitize or simplify or whitelist
   - todo/fix: check why summary can be nil/null
   note: content goes first; than try summary
 -->

  <p>So I wanted an autoclicker for linux - for one of my browser based games that require a lot of clicking.</p>
<p>Looked around and tried to find something useful, but all i could find was old pages outdated download links,..</p>
<p>In the end I stumbled upon something simple yet immensely more powerful:xdotool (github)  or check out the xdotool website</p>
<p>As an extra bonus it is in the Gentoo repository so a simple</p>
<pre>emerge xdotool</pre>
<p>Got it installed. it also has minimal dependencies which is nice.</p>
<p>The good part, but also a bit of a downside is that there is no UI (maybe I'll write one when I get a chance .. just as a wrapper).</p>
<p>anyway to do what I wanted was simply this:</p>
<pre>xdotool click --repeat 1000 --delay 100 1</pre>
<p>Pretty self explainatory, but here's a short explaination anyway:</p>
<ul>
<li>click .. simulate a mouse click</li>
<li>--repeat 1000 ... repeat 1000 times</li>
<li>--delay 100 ... wait 100ms between clicks</li>
<li>1  .. mouse button 1</li>
</ul>
<p>The only problem is I need to know how many clicks I need beforehand - which can also be a nice feature of course.</p>
<p>There is one way to stop it if you have the terminal you ran this command from visible (which i always have - and set it to always on top): click with your left mouse button - this stops the click events being registered since it is mouse-down and waits for mouse-up i guess .. but not sure if that is the reason. then move to the terminal and either close it or <code>ctrl+c</code> abort the command -- or just wait for the program to exit after finishing the requested number of clicks. -- On a side note if you don't like that way of stopping it you could always just <code>ctrl+alt+f1</code> (or whatever terminal you want to use) and log in there and kill the xdotool process (either find thepid and kill it or just <code>killall xdotool</code> - which will of course kill all, but i doubt you'll run more than one at once)</p>
<p></p>


 <span class='item-time-ago-in-words'>
 7 months ago
 </span>  
  
</div>

</div> <!-- item-body -->
</article><!-- item -->


  



<article class='item'>

<h4 class='feed-title'>
  <span class='feed-title'>
    <a href='http://blogs.gentoo.org/marecki/'>Marek Szuba</a>
  </span>
  <span class='item-published'>
     - 
      <!-- fix/todo: show year if not current year
           e.g. use "%b %d, '%y"
         -->
     Jul 03
  </span>
</h4>


<h3 class='item-title'>
  <i class='icon-caret-down item-collapse item-close item-opened'></i>
  <i class='icon-caret-right item-expand item-open item-closed'></i>
  <span class='item-title'>
    <a href='https://blogs.gentoo.org/marecki/2019/07/03/case-label-for-pocket-science-lab-v5/#utm_source=feed&utm_medium=feed&utm_campaign=feed'>Case label for Pocket Science Lab V5</a>
   </span>
</h3>

<div class='item-body'>
  
<div class='item-snippet'>
<!-- use 'smarter' algorithm for cutoff snippet text
   note: summary goes first; than try content -->

  tl;dr: Here (PDF, 67 kB) is a case label for Pocket Science Lab version 5 that is compatible with the design for a laser-cut case published by FOSSAsia. In case you haven&#8217;t heard about it, Pocket Science Lab [1] is a really nifty board developed by the FOSSAsia community which combines a multichannel, megahertz-range oscilloscope, &#8230; Continue reading Case label for Pocket Science Lab V5


 <span class='item-time-ago-in-words'>
 7 months ago
 </span>  
</div>

<div class='item-content item-summary'>

<!-- todo: use sanitize or simplify or whitelist
   - todo/fix: check why summary can be nil/null
   note: content goes first; than try summary
 -->

  <p>tl;dr: Here (PDF, 67 kB) is a case label for Pocket Science Lab version 5 that is compatible with the design for a laser-cut case published by FOSSAsia.</p>

<p>In case you haven&#8217;t heard about it, Pocket Science Lab [1] is a really nifty board developed by the FOSSAsia community which combines a multichannel, megahertz-range oscilloscope, a multimeter, a logic probe, several voltage sources and a current source, several wave generators, UART and I2C interfaces&#8230; and all of this in the form factor of an Arduino Mega, i.e. only somewhat larger than that of a credit card. Hook it up over USB to a PC or an Android device running the official (free and open source, of course) app and you are all set.</p>
<p>Well, not quite set yet. What you get for your 50-ish EUR is just the board itself. You will quite definitely need a set of probe cables (sadly, I have yet to find even an unofficial adaptor allowing one to equip PSLab with standard industry oscilloscope probes using BNC connectors) but if you expect to lug yours around anywhere you go, you will quite definitely want to invest in a case of some sort. While FOSSAsia does not to my knowledge sell PSLab cases, they provide a design for one [2]. It is meant to be laser-cut but I have successfully managed to 3D-print it as well, and for the more patient among us it shouldn&#8217;t be too difficult to hand-cut one with a jigsaw either.</p>
<p>Of course in addition to making sure your Pocket Science Lab is protected against accidental damage it would also be nice to have all the connectors clearly labelled. Documentation bundled with PSLab software does show not a few &#8220;how to connect instrument X&#8221; diagrams but unfortunately said diagrams picture a version 4 of the board and the current major version, V5, features radically different pinout (compare [3] with [4]/[5] and you will see immediately what I mean), not to mention that having to stare at a screen while wiring your circuit isn&#8217;t always optimal. Now, all versions of the board feature a complete set of header labels (along with LEDs showing the device is active) on the front side and at least the more recent ones additionally show more detailed descriptions on the back, clearly suggesting the optimal way to go is to make your case our of transparent material. But what if looking at the provided labels directly is not an option, for instance because you have gone eco-friendly and made your case out of wood? Probably stick a label to the front of the case&#8230; which brings us back to the problem of the case label from [5] not being compatible with recent versions of the board.</p>
<p>Which brings me to my take on adapting the design from [5] to match the header layout and labels of PSLab V5.1 as well as the laser-cut case design from [2]. It could probably be more accurate but having tried it out, it is close enough. Bluetooth and ICSP-programmer connectors near the centre of the board are not included because the current case design does not provide access to them and indeed, they haven&#8217;t even got headers soldered in. Licence and copyright: same as the original.</p>
<p><br>
[1] pslab.io/<br>
<br>
[2] github.com/fossasia/pslab-case<br>
<br>
[3] github.com/fossasia/pslab-hardware/raw/master/docs/images/PSLab_v5_top.png<br>
<br>
[4] github.com/fossasia/pslab-hardware/raw/master/docs/images/pslab_version_previews/PSLab_v4.png<br>
<br>
[5] github.com/fossasia/pslab-hardware/raw/master/docs/images/pslabdesign.png</p>


 <span class='item-time-ago-in-words'>
 7 months ago
 </span>  
  
</div>

</div> <!-- item-body -->
</article><!-- item -->


  



<article class='item'>

<h4 class='feed-title'>
  <span class='feed-title'>
    <a href='http://blogs.gentoo.org/blueknight/'>Yury German</a>
  </span>
  <span class='item-published'>
     - 
      <!-- fix/todo: show year if not current year
           e.g. use "%b %d, '%y"
         -->
     Apr 29
  </span>
</h4>


<h3 class='item-title'>
  <i class='icon-caret-down item-collapse item-close item-opened'></i>
  <i class='icon-caret-right item-expand item-open item-closed'></i>
  <span class='item-title'>
    <a href='https://blogs.gentoo.org/blueknight/2019/04/28/gentoo-blogs-update/#utm_source=feed&utm_medium=feed&utm_campaign=feed'>Gentoo Blogs Update</a>
   </span>
</h3>

<div class='item-body'>
  
<div class='item-snippet'>
<!-- use 'smarter' algorithm for cutoff snippet text
   note: summary goes first; than try content -->

  This is just a notification that the Blogs and the appropriate plug-ins for the release 5.1.1 have been updated. With the release of these updated we (The Gentoo Blog Team) have updated the themes that had updates. If you have a blog on this site, and have a theme that is based on one of [&#8230;]


 <span class='item-time-ago-in-words'>
 9 months ago
 </span>  
</div>

<div class='item-content item-summary'>

<!-- todo: use sanitize or simplify or whitelist
   - todo/fix: check why summary can be nil/null
   note: content goes first; than try summary
 -->

  <p>This is just a notification that the Blogs and the appropriate plug-ins for the release 5.1.1 have been updated. </p>



<p>With the release of these updated we (The Gentoo Blog Team) have updated the themes that had updates.  If you have a blog on this site, and have a theme that is based on one of the following themes please consider updating as these themes are no longer updated and things will break in your blogs.</p>



<ul><li>KDE Breathe</li><li>KDE Graffiti</li><li>Oxygen </li><li>The Following WordPress versions might stop working (Simply because of age)<ul><li>Twenty Fourteen</li><li>Twenty Fifteen</li><li>Twenty Sixteen</li></ul></li></ul>



<p>If you are using one of these themes it is recommended that you update to the other themes available. If you think that there is an open source theme that you would like to have available please contact the Blogs team by opening a Bugzilla Bug with pertinent information. </p>


 <span class='item-time-ago-in-words'>
 9 months ago
 </span>  
  
</div>

</div> <!-- item-body -->
</article><!-- item -->


  



<article class='item'>

<h4 class='feed-title'>
  <span class='feed-title'>
    <a href='http://www.gentoo.org/rdf/en/gentoo-news.rdf'>Gentoo News</a>
  </span>
  <span class='item-published'>
     - 
      <!-- fix/todo: show year if not current year
           e.g. use "%b %d, '%y"
         -->
     Apr 16
  </span>
</h4>


<h3 class='item-title'>
  <i class='icon-caret-down item-collapse item-close item-opened'></i>
  <i class='icon-caret-right item-expand item-open item-closed'></i>
  <span class='item-title'>
    <a href='https://www.gentoo.org/news/2019/04/16/nitrokey.html'>Nitrokey partners with Gentoo Foundation to equip developers with USB keys</a>
   </span>
</h3>

<div class='item-body'>
  
<div class='item-snippet'>
<!-- use 'smarter' algorithm for cutoff snippet text
   note: summary goes first; than try content -->

  <p>
  ♦
</p>

<p>The Gentoo Foundation has
partnered with Nitrokey to equip all Gentoo developers
with free Nitrokey Pro 2
devices. Gentoo developers will use the Nitrokey devices to store cryptographic
keys for signing of git commits and software packages, GnuPG keys, and SSH
accounts.</p>

<!--more-->

<p>Thanks to the Gentoo Foundation and Nitrokey’s discount, each Gentoo developer
is eligible t


 <span class='item-time-ago-in-words'>
 10 months ago
 </span>  
</div>

<div class='item-content item-summary'>

<!-- todo: use sanitize or simplify or whitelist
   - todo/fix: check why summary can be nil/null
   note: content goes first; than try summary
 -->

  <p>
  ♦
</p>

<p>The Gentoo Foundation has
partnered with Nitrokey to equip all Gentoo developers
with free Nitrokey Pro 2
devices. Gentoo developers will use the Nitrokey devices to store cryptographic
keys for signing of git commits and software packages, GnuPG keys, and SSH
accounts.</p>

<!--more-->

<p>Thanks to the Gentoo Foundation and Nitrokey’s discount, each Gentoo developer
is eligible to receive one free Nitrokey Pro 2. To receive their Nitrokey, developers
will need to register with their <code>@gentoo.org</code> email address at the dedicated order
form.</p>

<p>A Nitrokey Pro 2 Guide is available
on the Gentoo Wiki with FAQ &amp; instructions for integrating Nitrokeys into developer
workflow.</p>

ABOUT NITROKEY PRO 2

<p>Nitrokey Pro 2
has strong reliable hardware encryption, thanks to open source.  It can help
you to: sign Git commits; encrypt emails and files; secure server access; and
protect accounts against identity theft via two-factor authentication (one-time
passwords).</p>

ABOUT GENTOO

<p>Gentoo Linux is a free, source-based, rolling
release meta distribution that features a high degree of flexibility and high
performance. It empowers you to make your computer work for you, and offers a
variety of choices at all levels of system configuration.</p>

<p>As a community, Gentoo consists of approximately two hundred developers and
over fifty thousand users globally.</p>

<p>The Gentoo Foundation
supports the development of Gentoo, protects Gentoo’s intellectual property,
and oversees adherence to Gentoo’s Social Contract.</p>

ABOUT NITROKEY

<p>Nitrokey is a German IT security startup committed
to open source hardware and software. Nitrokey develops and produces USB keys
for data encryption, email encryption (PGP/GPG, S/MIME), and secure account
logins (SSH, two-factor authentication via OTP and FIDO).</p>

<p>Nitrokey is proud to support the Gentoo Foundation in further securing the
Gentoo infrastructure and contributing to a secure open source Linux
ecosystem.</p>


 <span class='item-time-ago-in-words'>
 10 months ago
 </span>  
  
</div>

</div> <!-- item-body -->
</article><!-- item -->


  



<article class='item'>

<h4 class='feed-title'>
  <span class='feed-title'>
    <a href='http://www.gentoo.org/rdf/en/gentoo-news.rdf'>Gentoo News</a>
  </span>
  <span class='item-published'>
     - 
      <!-- fix/todo: show year if not current year
           e.g. use "%b %d, '%y"
         -->
     Mar 27
  </span>
</h4>


<h3 class='item-title'>
  <i class='icon-caret-down item-collapse item-close item-opened'></i>
  <i class='icon-caret-right item-expand item-open item-closed'></i>
  <span class='item-title'>
    <a href='https://www.gentoo.org/news/2019/03/27/gnome-330-openrc.html'>Gentoo GNOME 3.30 for all init systems</a>
   </span>
</h3>

<div class='item-body'>
  
<div class='item-snippet'>
<!-- use 'smarter' algorithm for cutoff snippet text
   note: summary goes first; than try content -->

  <p>
  ♦
</p>

<p>GNOME 3.30 is now 
available in Gentoo Linux testing branch. Starting with this release, GNOME on 
Gentoo once again works with OpenRC, 
in addition to the usual systemd option. This is achieved through the elogind 
project, a standalone logind implementation 
based on systemd code, which is currently maintained by a fellow Gentoo user. 
Gentoo would like to thank Mart Raudsepp (le


 <span class='item-time-ago-in-words'>
 10 months ago
 </span>  
</div>

<div class='item-content item-summary'>

<!-- todo: use sanitize or simplify or whitelist
   - todo/fix: check why summary can be nil/null
   note: content goes first; than try summary
 -->

  <p>
  ♦
</p>

<p>GNOME 3.30 is now 
available in Gentoo Linux testing branch. Starting with this release, GNOME on 
Gentoo once again works with OpenRC, 
in addition to the usual systemd option. This is achieved through the elogind 
project, a standalone logind implementation 
based on systemd code, which is currently maintained by a fellow Gentoo user. 
Gentoo would like to thank Mart Raudsepp (leio), Gavin Ferris, and all others
working on this for their contributions. More information can be found in
Mart’s blog post.</p>


 <span class='item-time-ago-in-words'>
 10 months ago
 </span>  
  
</div>

</div> <!-- item-body -->
</article><!-- item -->


  <!-- each item (inside column) -->
 </td>



<td valign='top'>
  <!-- start new column -->

  



<article class='item'>

<h4 class='feed-title'>
  <span class='feed-title'>
    <a href='http://www.ultrabug.fr/'>Alexys Jacob</a>
  </span>
  <span class='item-published'>
     - 
      <!-- fix/todo: show year if not current year
           e.g. use "%b %d, '%y"
         -->
     Dec 28
  </span>
</h4>


<h3 class='item-title'>
  <i class='icon-caret-down item-collapse item-close item-opened'></i>
  <i class='icon-caret-right item-expand item-open item-closed'></i>
  <span class='item-title'>
    <a href='https://www.ultrabug.fr/scylla-summit-2019/'>Scylla Summit 2019</a>
   </span>
</h3>

<div class='item-body'>
  
<div class='item-snippet'>
<!-- use 'smarter' algorithm for cutoff snippet text
   note: summary goes first; than try content -->

  I&#8217;ve had the pleasure to attend again and present at the Scylla Summit in San Francisco and the honor to be awarded the Most innovative use case of Scylla. It was a great event, full of friendly people and passionate conversations. Peter did a great full write-up of it already so I wanted to share [&#8230;]


 <span class='item-time-ago-in-words'>
 1 months ago
 </span>  
</div>

<div class='item-content item-summary'>

<!-- todo: use sanitize or simplify or whitelist
   - todo/fix: check why summary can be nil/null
   note: content goes first; than try summary
 -->

  <p>I&#8217;ve had the pleasure to attend again and present at the Scylla Summit in San Francisco and the honor to be awarded the Most innovative use case of Scylla.</p>



<p>It was a great event, full of friendly people and passionate conversations. Peter did a great full write-up of it already so I wanted to share some of my notes instead&#8230;</p>



<p>This a curated set of topics that I happened to question or discuss in depth so this post is not meant to be taken as a full coverage of the conference.</p>



 Scylla Manager version 2



<p>The upcoming version of scylla-manager is dropping its dependency on SSH setup which will be replaced by an agent, most likely shipped as a separate package.</p>



<p>On the features side, I was a bit puzzled by the fact that ScyllaDB is advertising that its manager will provide a repair scheduling window so that you can control when it&#8217;s running or not.</p>



<p>Why did it struck me you ask?</p>



<p>Because MongoDB does the same thing within its balancer process and I always thought of this as a patch to a feature that the database should be able to cope with by itself.</p>



<p>And that database-do-it-better-than-you motto is exactly one of the promises of Scylla, the boring database, so smart at handling workload impacts on performance that you shouldn&#8217;t have to start playing tricks to mitigate them&#8230; I don&#8217;t want this time window feature on scylla-manager to be a trojan horse on the demise of that promise!</p>



Kubernetes



<p> They almost got late on this but are working hard to play well with the new toy of every tech around the world. Helm charts are also being worked on!</p>



<p>The community developed scylla operator by Yannis is now being worked on and backed by ScyllaDB. It can deploy, scale up and down a cluster.</p>



<p>Few things to note:</p>



<ul><li>it&#8217;s using a configmap to store the scylla config</li><li>no TLS support yet</li><li>no RBAC support yet</li><li>kubernetes networking is lighter on the network performance hit that was seen on Docker</li><li>use placement strategies to dedicate kubernetes nodes to scylla! </li></ul>



Change Data Capture



<p>Oh boy this one was awaited&#8230; but it&#8217;s now coming soon!</p>



<p>I inquired about it&#8217;s performance impact since every operation will be written to a table. Clearly my questioning was a bit alpha since CDC is still being worked on.</p>



<p>I had the chance to discuss ideas with Kamil, Tzach and Dor: one of the thing that one of my colleague Julien asked for was the ability for the CDC to generate an event when a tombstone is written so we could actually know when a specific data expired! </p>



<p>I want to stress a few other things too:</p>



<ul><li>default TTL on CDC table is 24H</li><li>expect I/O impact (logical)</li><li>TTL tombstones can have a hidden disk space cost and nobody was able to tell me if the CDC table was going to be configured with a lower gc_grace_period than the default 10 days so that&#8217;s something we need to keep in mind and check for</li><li>there was no plan to add user information that would allow us to know who actually did the operation, so that&#8217;s something I asked for because it could be used as a cheap and open source way to get auditing!</li></ul>



LightWeight Transactions



<p>Another so long awaited feature is also coming from the amazing work and knowledge of Konstantin. We had a great conversation about the differences between the currently worked on Paxos based LWT implementation and the maybe later Raft one.</p>



<p>So yes, the first LWT implementation will be using Paxos as a consensus algorithm. This will make the LWT feature very consistent while having it slower that what could be achieved using Raft. That&#8217;s why ScyllaDB have plans on another implementation that could be faster with less data consistency guarantees.</p>



User Defined Functions / Aggregations



<p> This one is bringing the Lua language inside Scylla!</p>



<p>To be precise, it will be a Lua JIT as its footprint is low and Lua can be cooperative enough but the ScyllaDB people made sure to monitor its violations (when it should yield but does not) and act strongly upon them.</p>



<p>I got into implementation details with Avi, this is what I noted:</p>



<ul><li>lua function return type is not checked at creation but at execution, so expect runtime errors if your lua code is bad</li><li>since lua is lightweight, there&#8217;s no need to assign a core to lua execution</li><li>I found UDA examples, like top-k rows, to be very similar to the Map/Reduce logic</li><li>UDF will allow simpler token range full table scans thanks to syntax sugar</li><li>there will be memory limits applied to result sets from UDA, and they will be tunable</li></ul>



Text search



<p>Dejan is the text search guy at ScyllaDB and the one who kindly implemented the LIKE feature we asked for and that will be released in the upcoming 3.2 version.</p>



<p>We discussed ideas and projected use cases to make sure that what&#8217;s going to be worked on will be used!</p>



 Redis API



<p>I&#8217;ve always been frustrated about Redis because while I love the technology I never trusted its clustering and scaling capabilities.</p>



<p>What if you could scale your Redis like Scylla without giving up on performance? That&#8217;s what the implementation of the Redis API backed by Scylla will get us!</p>



<p>I&#8217;m desperately looking forward to see this happen!</p>


 <span class='item-time-ago-in-words'>
 1 months ago
 </span>  
  
</div>

</div> <!-- item-body -->
</article><!-- item -->


  



<article class='item'>

<h4 class='feed-title'>
  <span class='feed-title'>
    <a href='http://blogs.gentoo.org/mgorny/'>Michał Górny</a>
  </span>
  <span class='item-published'>
     - 
      <!-- fix/todo: show year if not current year
           e.g. use "%b %d, '%y"
         -->
     Dec 19
  </span>
</h4>


<h3 class='item-title'>
  <i class='icon-caret-down item-collapse item-close item-opened'></i>
  <i class='icon-caret-right item-expand item-open item-closed'></i>
  <span class='item-title'>
    <a href='https://blogs.gentoo.org/mgorny/2019/12/19/a-distribution-kernel-for-gentoo/'>A distribution kernel for Gentoo</a>
   </span>
</h3>

<div class='item-body'>
  
<div class='item-snippet'>
<!-- use 'smarter' algorithm for cutoff snippet text
   note: summary goes first; than try content -->

  The&#160;traditional Gentoo way of&#160;getting a&#160;kernel is to&#160;install the&#160;sources, and&#160;then configure and&#160;build one yourself. For&#160;those who didn&#8217;t want to go through the&#160;tedious process of&#160;configuring it manually, an&#160;alternative route of&#160;using genkernel was provided. However, neither of&#160;those variants was able to&#160;really provide the&


 <span class='item-time-ago-in-words'>
 1 months ago
 </span>  
</div>

<div class='item-content item-summary'>

<!-- todo: use sanitize or simplify or whitelist
   - todo/fix: check why summary can be nil/null
   note: content goes first; than try summary
 -->

  <p>The&nbsp;traditional Gentoo way of&nbsp;getting a&nbsp;kernel is to&nbsp;install the&nbsp;sources, and&nbsp;then configure and&nbsp;build one yourself.  For&nbsp;those who didn&#8217;t want to go through the&nbsp;tedious process of&nbsp;configuring it manually, an&nbsp;alternative route of&nbsp;using genkernel was provided.  However, neither of&nbsp;those variants was able to&nbsp;really provide the&nbsp;equivalent of&nbsp;kernels provided by&nbsp;binary distributions.</p>
<p>I&nbsp;have manually configured the&nbsp;kernels for my private systems long time ago.  Today, I&nbsp;wouldn&#8217;t really have bothered.  In&nbsp;fact, I&nbsp;realized that for&nbsp;some time I&#8217;m really hesitant to&nbsp;even upgrade them because of&nbsp;the&nbsp;effort needed to&nbsp;update configuration.  The&nbsp;worst part is, whenever a&nbsp;new kernel does not boot, I&nbsp;have to&nbsp;ask myself: is it a&nbsp;real bug, or&nbsp;is it my fault for&nbsp;configuring it wrong?</p>
<p>I&#8217;m not alone in&nbsp;this.  Recently Михаил Коляда (zlogene) has talked to&nbsp;me about providing binary kernels for&nbsp;Gentoo.  While I&nbsp;have not strictly implemented what he had in&nbsp;mind, he inspired me to&nbsp;start working on&nbsp;a&nbsp;distribution kernel.  The&nbsp;goal was to&nbsp;create a&nbsp;kernel package that users can install to&nbsp;get a&nbsp;working kernel with minimal effort, and&nbsp;that would be&nbsp;upgraded automatically as&nbsp;part of&nbsp;regular @world upgrades.</p>
<p></p>
Pros and&nbsp;cons of&nbsp;your own kernel
<p>If&nbsp;I&nbsp;am to&nbsp;justify switching from the&nbsp;old tradition of&nbsp;custom kernels to&nbsp;a&nbsp;universal kernel package, I&nbsp;should start by&nbsp;discussing the&nbsp;reasons why you may want to&nbsp;configure a&nbsp;custom kernel in&nbsp;the&nbsp;first place.</p>
<p>In&nbsp;my opinion, the&nbsp;most important feature of&nbsp;a&nbsp;custom kernel is that you can fine-tune it to&nbsp;your hardware.  You just have to&nbsp;build the&nbsp;drivers you need (or&nbsp;may need), and&nbsp;the&nbsp;features you care about.  The&nbsp;modules for my last custom kernel have occupied 44&nbsp;MiB.  The&nbsp;modules for the&nbsp;distribution kernel occupy 294&nbsp;MiB.  Such a&nbsp;difference in&nbsp;size also comes with a&nbsp;proportional increase of&nbsp;build time.  This can be an&nbsp;important argument for&nbsp;people with low-end hardware.  On&nbsp;the&nbsp;other hand, the&nbsp;distribution kernel permits building reusable binary packages that can save more computing power.</p>
<p>The&nbsp;traditional Gentoo argument is&nbsp;performance.  However, these days I&nbsp;would be&nbsp;very careful arguing about that.  I&nbsp;suppose you are able to&nbsp;reap benefits if&nbsp;you know how to&nbsp;configure your kernel towards a&nbsp;specific workload.  But then — a&nbsp;misconfiguration can have the&nbsp;exact opposite effect.  We must not&nbsp;forget that binary distributions are important players in&nbsp;the&nbsp;field — and&nbsp;the&nbsp;kernel must also be&nbsp;able to&nbsp;achieve good performance when not using a&nbsp;dedicated configuration.</p>
<p>At&nbsp;some point I have worked on&nbsp;achieving a&nbsp;very fast startup.  For&nbsp;this reason I&#8217;ve switched to&nbsp;using LILO as&nbsp;the&nbsp;bootloader, and&nbsp;a&nbsp;kernel suitable for&nbsp;booting my system without an&nbsp;initramfs.  A&nbsp;universal kernel naturally needs an&nbsp;initramfs, and&nbsp;is slower to&nbsp;boot.</p>
<p>The&nbsp;main counterargument is the&nbsp;effort.  As&nbsp;mentioned earlier, I&#8217;ve personally grown tired of&nbsp;having to&nbsp;manually deal with my kernel.  Do&nbsp;the&nbsp;potential gains mentioned outweigh the&nbsp;loss of&nbsp;human time on&nbsp;configuring and&nbsp;maintaining a&nbsp;custom kernel?</p>
Creating a&nbsp;truly universal kernel
<p>A&nbsp;distribution kernel makes sense only if&nbsp;it works on&nbsp;a&nbsp;wide range of&nbsp;systems.  Furthermore, I&nbsp;didn&#8217;t forget the&nbsp;original idea of&nbsp;binary kernel packages.  I&nbsp;didn&#8217;t want to write an&nbsp;ebuild that can install a&nbsp;working kernel anywhere.  I&nbsp;wanted to&nbsp;create an&nbsp;ebuild that can be&nbsp;used to&nbsp;build a&nbsp;binary package that&#8217;s going to&nbsp;work on&nbsp;a&nbsp;wide range of&nbsp;setups — including not only different hardware but&nbsp;also bootloaders and&nbsp;/boot layout.  A&nbsp;package that would work fine both for&nbsp;my ‘traditional’ LILO setup and&nbsp;UEFI systemd-boot setup.</p>
<p>The&nbsp;first part of&nbsp;a&nbsp;distribution kernel is&nbsp;the&nbsp;right configuration.  I&nbsp;wanted to&nbsp;use a&nbsp;well-tested configuration known to&nbsp;build kernels used on&nbsp;many systems, while at&nbsp;the&nbsp;same time minimizing the&nbsp;maintenance effort on&nbsp;our end.  Reusing the&nbsp;configuration from a&nbsp;binary distro was the&nbsp;obvious solution.  I&nbsp;went for&nbsp;using the&nbsp;config from&nbsp;Arch Linux&#8217;s kernel package with minimal changes (e.g. changing the&nbsp;default hostname to&nbsp;Gentoo).</p>
<p>The&nbsp;second part is an&nbsp;initramfs.  Since we need to&nbsp;support a&nbsp;wide variety of&nbsp;setups, we can&#8217;t get away without it.  To&nbsp;follow the&nbsp;configuration used, Dracut was the&nbsp;natural choice.</p>
<p>The&nbsp;third and&nbsp;hardest part is installing it all.  Since I&#8217;ve already set a&nbsp;goal of&nbsp;reusing the&nbsp;same binary package on&nbsp;different filesystem layouts, the&nbsp;actual installation needed to be&nbsp;moved to&nbsp;postinst phase.  Our distribution kernel package installs the&nbsp;kernel into an&nbsp;interim location which is entirely setup-independent, rendering the&nbsp;binary packages setup-agnostic as&nbsp;well.  The&nbsp;initramfs is&nbsp;created and&nbsp;installed into the&nbsp;final location along with the&nbsp;kernel in&nbsp;pkg_postinst.</p>
<p>Support for&nbsp;different install layouts is provided by&nbsp;reusing the&nbsp;installkernel tool, originally installed by&nbsp;debianutils.  As&nbsp;part of&nbsp;the&nbsp;effort, it was extended with initramfs support and&nbsp;moved into a&nbsp;separate&nbsp;sys-kernel/installkernel-gentoo package.  Furthermore, an&nbsp;alternative sys-kernel/installkernel-systemd-boot package was created to&nbsp;provide an&nbsp;out-of-the-box support for&nbsp;systemd-boot layout.  If&nbsp;neither of&nbsp;those two work for you, you can easily create your own /usr/local/bin/installkernel that follows your own layout.</p>
Summary
<p>The&nbsp;experimental versions of&nbsp;the&nbsp;distribution kernel are packaged as&nbsp;sys-kernel/vanilla-kernel (in&nbsp;distinction from&nbsp;sys-kernel/vanilla-sources that install the&nbsp;sources).  Besides providing the&nbsp;default zero-effort setup, the&nbsp;package supports using your own configuration via&nbsp;savedconfig (but no&nbsp;easy way to&nbsp;update it at&nbsp;the&nbsp;moment).  It also provides a&nbsp;forced flag that can be&nbsp;used by&nbsp;expert users to disable the&nbsp;initramfs.</p>
<p>The&nbsp;primary goal at&nbsp;the&nbsp;moment is to&nbsp;test the&nbsp;package and&nbsp;find bugs that could prevent our users from using it.  In&nbsp;the&nbsp;future, we&#8217;re planning to&nbsp;extend it to&nbsp;other architectures, kernel variants (Gentoo patch set in&nbsp;particular) and&nbsp;LTS versions.  We&#8217;re also considering providing prebuilt binary packages — however, this will probably be a&nbsp;part of&nbsp;a&nbsp;bigger effort into providing an&nbsp;official Gentoo binhost.</p>


 <span class='item-time-ago-in-words'>
 1 months ago
 </span>  
  
</div>

</div> <!-- item-body -->
</article><!-- item -->


  



<article class='item'>

<h4 class='feed-title'>
  <span class='feed-title'>
    <a href='http://blogs.gentoo.org/mgorny/'>Michał Górny</a>
  </span>
  <span class='item-published'>
     - 
      <!-- fix/todo: show year if not current year
           e.g. use "%b %d, '%y"
         -->
     Nov 06
  </span>
</h4>


<h3 class='item-title'>
  <i class='icon-caret-down item-collapse item-close item-opened'></i>
  <i class='icon-caret-right item-expand item-open item-closed'></i>
  <span class='item-title'>
    <a href='https://blogs.gentoo.org/mgorny/2019/11/06/gentoo-eclass-design-pitfalls/'>Gentoo eclass design pitfalls</a>
   </span>
</h3>

<div class='item-body'>
  
<div class='item-snippet'>
<!-- use 'smarter' algorithm for cutoff snippet text
   note: summary goes first; than try content -->

  I have written my share of&#160;eclasses, and&#160;I have made my share of&#160;mistakes. Designing good eclasses is a&#160;non-trivial problem, and&#160;there are many pitfalls you should be&#160;watching for. In&#160;this post, I would like to&#160;highlight three of&#160;them. Not all metadata variables are combined PMS provides a&#160;convenient feature for eclass writers: cumulative handling o


 <span class='item-time-ago-in-words'>
 3 months ago
 </span>  
</div>

<div class='item-content item-summary'>

<!-- todo: use sanitize or simplify or whitelist
   - todo/fix: check why summary can be nil/null
   note: content goes first; than try summary
 -->

  <p>I have written my share of&nbsp;eclasses, and&nbsp;I have made my share of&nbsp;mistakes.  Designing good eclasses is a&nbsp;non-trivial problem, and&nbsp;there are many pitfalls you should be&nbsp;watching for.  In&nbsp;this post, I would like to&nbsp;highlight three of&nbsp;them.</p>
Not all metadata variables are combined
<p>PMS provides a&nbsp;convenient feature for eclass writers: cumulative handling of&nbsp;metadata variables.  Quoting the&nbsp;relevant passage:</p>
<blockquote><p>The IUSE, REQUIRED_USE, DEPEND, BDEPEND, RDEPEND and&nbsp;PDEPEND variables are handled specially when set by an eclass. They must be accumulated across eclasses, appending the value set by each eclass to the resulting value after the previous one is loaded. Then the eclass-defined value is appended to that defined by the ebuild. […]</p>
<p><cite>Package Manager Specification (30th April 2018), 10.2 Eclass-defined Metadata Keys</cite></p></blockquote>
<p>That&#8217;s really handy!  However, the&nbsp;important thing that&#8217;s not&nbsp;obvious from this description is that not all metadata variables work this way.  The&nbsp;following multi-value variables don&#8217;t: HOMEPAGE, SRC_URI, LICENSE, KEYWORDS, PROPERTIES and&nbsp;RESTRICT.  Surely, some of&nbsp;them are not&nbsp;supposed to&nbsp;be&nbsp;set in&nbsp;eclasses but&nbsp;e.g.&nbsp;the&nbsp;last two are confusing.</p>
<p>This means that technically you need to&nbsp;append when defining them, e.g.:</p>
<pre><code># my.eclass
RESTRICT+=" !test? ( test )"</code></pre>
<p>However, that&#8217;s not&nbsp;the&nbsp;biggest problem.  The&nbsp;real issue is that those variables are normally set in&nbsp;ebuilds after inherit, so you actually need to&nbsp;make sure that all ebuilds append to&nbsp;them.  For&nbsp;example, the&nbsp;ebuild needs to do:</p>
<pre><code># my-1.ebuild
inherit my
RESTRICT+=" bindist"</code></pre>
<p>Therefore, this design is&nbsp;prone to&nbsp;mistakes at&nbsp;ebuild level.  I&#8217;m going to&nbsp;discuss an&nbsp;alternative solution below.</p>
Declarative vs functional
<p>It is common to&nbsp;use declarative style in&nbsp;eclasses — create a&nbsp;bunch of&nbsp;variables that ebuilds can use to&nbsp;control the&nbsp;eclass behavior.  However, this style has two significant disadvantages.</p>
<p>Firstly, it is prone to&nbsp;typos.  If&nbsp;someone recalls the&nbsp;variable name wrong, and&nbsp;its effects are not&nbsp;explicitly visible, it is very easy to&nbsp;commit an&nbsp;ebuild with a&nbsp;silly bug.  If&nbsp;the&nbsp;effects are&nbsp;visible, it can still give you some quality debugging headache.</p>
<p>Secondly, in&nbsp;order to&nbsp;affect global scope, the&nbsp;variables need to be&nbsp;set before inherit.  This is not&nbsp;trivially enforced, and&nbsp;it is easy to&nbsp;miss that the&nbsp;variable doesn&#8217;t work (or&nbsp;partially misbehaves) when set too&nbsp;late.</p>
<p>The&nbsp;alternative is to&nbsp;use functional style, especially for&nbsp;affecting global scope variables.  Instead of&nbsp;immediately editing variables in&nbsp;global scope and&nbsp;expecting ebuilds to&nbsp;control the&nbsp;behavior via&nbsp;variables, give them a&nbsp;function to do it:</p>
<pre><code># my.eclass
my_enable_pytest() {
  IUSE+=" test"
  RESTRICT+=" !test? ( test )"
  BDEPEND+=" test? ( dev-python/pytest[${PYTHON_USEDEP}] )"
  python_test() {
    pytest -vv || die
  }
}</code></pre>
<p>Note that this function is&nbsp;evaluated in&nbsp;ebuild context, so all variables need appending.  Its main advantage is that it works independently of&nbsp;where in&nbsp;ebuild it&#8217;s called (but&nbsp;if&nbsp;you call it early, remember to&nbsp;append!), and&nbsp;in&nbsp;case of&nbsp;typo you get an&nbsp;explicit error.  Example use in&nbsp;ebuild:</p>
<pre><code># my-1.ebuild
inherit my
IUSE="randomstuff"
RDEPEND="randomstuff? ( dev-libs/random )"
my_enable_pytest</code></pre>
Think what phases to&nbsp;export
<p>Exporting phase functions is often a&nbsp;matter of&nbsp;convenience.  However, doing it&nbsp;poorly can cause ebuild writers more pain than if&nbsp;they weren&#8217;t exported in&nbsp;the&nbsp;first place.  An&nbsp;example of&nbsp;this is&nbsp;vala.eclass as&nbsp;of&nbsp;today.  It wrongly exports dysfunctional src_prepare(), and&nbsp;all ebuilds have to&nbsp;redefine it anyway.</p>
<p>It is often a&nbsp;good idea to&nbsp;consider how your eclass is&nbsp;going to be&nbsp;used.  If&nbsp;there are&nbsp;both use cases for&nbsp;having the&nbsp;phases exported and&nbsp;for&nbsp;providing utility functions without any&nbsp;phases, it is probably a&nbsp;good idea to&nbsp;split the&nbsp;eclass in&nbsp;two: into -utils eclass that just provides the&nbsp;functions, and&nbsp;main eclass that combines them with phase functions.  A&nbsp;good examples today are xdg and&nbsp;xdg-utils eclasses.</p>
<p>When you do&nbsp;need to&nbsp;export phases, it is wortwhile to&nbsp;consider how different eclasses are going to be&nbsp;combined.  Generally, a&nbsp;few eclass types could be listed:</p>
<ul>
<li>Unpacking (fetching) eclasses; e.g.&nbsp;git-r3 with src_unpack(),</li>
<li>Build system eclasses; e.g.&nbsp;cmake-utils, src_prepare() through src_install(),</li>
<li>Post-install eclasses; e.g.&nbsp;xdg, pkg_*inst(), pkg_*rm(),</li>
<li>Build environment setup eclasses; e.g.&nbsp;python-single-r1, pkg_setup().</li>
</ul>
<p>Generally, it&#8217;s best to&nbsp;fit your eclass into as&nbsp;few of&nbsp;those as&nbsp;possible.  If&nbsp;you do that, there&#8217;s a&nbsp;good chance that the&nbsp;ebuild author would be&nbsp;able to&nbsp;combine multiple eclasses easily:</p>
<pre><code># my-1.ebuild
PYTHON_COMPAT=( python3_7 )
inherit cmake-utils git-r3 python-single-r1</code></pre>
<p>Note that since each of&nbsp;those eclasses uses a&nbsp;different phase function set to do&nbsp;its work, they combine just fine!  The&nbsp;inherit order is also irrelevant.  If&nbsp;we e.g.&nbsp;need to&nbsp;add llvm to the&nbsp;list, we just have to&nbsp;redefine pkg_setup().</p>


 <span class='item-time-ago-in-words'>
 3 months ago
 </span>  
  
</div>

</div> <!-- item-body -->
</article><!-- item -->


  



<article class='item'>

<h4 class='feed-title'>
  <span class='feed-title'>
    <a href='https://blog.lordvan.com/blog/'>Thomas Raschbacher</a>
  </span>
  <span class='item-published'>
     - 
      <!-- fix/todo: show year if not current year
           e.g. use "%b %d, '%y"
         -->
     Oct 04
  </span>
</h4>


<h3 class='item-title'>
  <i class='icon-caret-down item-collapse item-close item-opened'></i>
  <i class='icon-caret-right item-expand item-open item-closed'></i>
  <span class='item-title'>
    <a href='https://blog.lordvan.com/blog/gentoo-network-bridge-device-for-qemu-kvm/'>[gentoo] Network Bridge device for Qemu kvm</a>
   </span>
</h3>

<div class='item-body'>
  
<div class='item-snippet'>
<!-- use 'smarter' algorithm for cutoff snippet text
   note: summary goes first; than try content -->

  <p>So I needed to set up qemu+kvm on a new server (After the old one died)</p>
<p>Seems like i forgot to mention how I set up the bridge network on my previous blog post so here you go:</p>
<p>First let me mention that I am using the second physical Interface on the server for the bridge. Depending on your available hardware or use case you might need / want to change this:</p>
<p>So this is fairly


 <span class='item-time-ago-in-words'>
 4 months ago
 </span>  
</div>

<div class='item-content item-summary'>

<!-- todo: use sanitize or simplify or whitelist
   - todo/fix: check why summary can be nil/null
   note: content goes first; than try summary
 -->

  <p>So I needed to set up qemu+kvm on a new server (After the old one died)</p>
<p>Seems like i forgot to mention how I set up the bridge network on my previous blog post so here you go:</p>
<p>First let me mention that I am using the second physical Interface on the server for the bridge. Depending on your available hardware or use case you might need / want to change this:</p>
<p>So this is fairly simple (if one has a properly configured kernel of course - details on the Gentoo Wiki article on Network Bridges):</p>
<p>First add this in your /etc/conf.d/net (adjust the interface names as needed):</p>
<pre># QEMU / KVM bridge<br>bridge_br0="enp96s0f1"<br>config_br0="dhcp"</pre>
<p>then add an init script and start it:</p>
<pre>cd /etc/init.d; ln -s net.lo net.br0<br>/etc/init.d/net.br0 start # to test it</pre>
<p>So then I get this error when trying to start my kvm/qemu instance:</p>
<pre> * creating qtap (auto allocating one) ...<br>/usr/sbin/qtap-manipulate: line 28: tunctl: command not found<br>tunctl failed<br> * failed to create qtap interface</pre>
<p>seems like I was missing <code>sys-apps/usermode-utilities</code> .. so just emerge that, only to get this:</p>
<pre> * creating qtap (auto allocating one) ...<br>/usr/sbin/qtap-manipulate: line 29: brctl: command not found<br>brctl failed<br> * failed to create qtap interface</pre>
<p>yepp I forgot to install that too ^^ .. so Install <code>net-misc/bridge-utils</code> and now it starts the VM</p>


 <span class='item-time-ago-in-words'>
 4 months ago
 </span>  
  
</div>

</div> <!-- item-body -->
</article><!-- item -->


  



<article class='item'>

<h4 class='feed-title'>
  <span class='feed-title'>
    <a href='http://www.ultrabug.fr/'>Alexys Jacob</a>
  </span>
  <span class='item-published'>
     - 
      <!-- fix/todo: show year if not current year
           e.g. use "%b %d, '%y"
         -->
     Sep 22
  </span>
</h4>


<h3 class='item-title'>
  <i class='icon-caret-down item-collapse item-close item-opened'></i>
  <i class='icon-caret-right item-expand item-open item-closed'></i>
  <span class='item-title'>
    <a href='https://www.ultrabug.fr/py3status-v3-20-europython-2019-edition/'>py3status v3.20 – EuroPython 2019 edition</a>
   </span>
</h3>

<div class='item-body'>
  
<div class='item-snippet'>
<!-- use 'smarter' algorithm for cutoff snippet text
   note: summary goes first; than try content -->

  Shame on me to post this so long after it happened&#8230; Still, that&#8217;s a funny story to tell and a lot of thank you to give so let&#8217;s go! The py3status EuroPython 2019 sprint I&#8217;ve attended all EuroPython conferences since 2013. It&#8217;s a great event and I encourage everyone to get there! The last two [&#8230;]


 <span class='item-time-ago-in-words'>
 4 months ago
 </span>  
</div>

<div class='item-content item-summary'>

<!-- todo: use sanitize or simplify or whitelist
   - todo/fix: check why summary can be nil/null
   note: content goes first; than try summary
 -->

  <p>Shame on me to post this so long after it happened&#8230; Still, that&#8217;s a funny story to tell and a lot of thank you to give so let&#8217;s go!</p>



The py3status EuroPython 2019 sprint



<p>I&#8217;ve attended all EuroPython conferences since 2013. It&#8217;s a great event and I encourage everyone to get there!</p>



<p>The last two days of the conference week are meant for Open Source projects collaboration: this is called sprints.</p>



<p>I don&#8217;t know why but this year I decided that I would propose a sprint to welcome anyone willing to work on py3status to come and help&#8230;</p>



<p>To be honest I was expecting that nobody would be interested so when I sat down at an empty table on saturday I thought that it would remain empty&#8230; but hey, I would have worked on py3status anyway so every option was okay!</p>



<p>Then two students came. They ran Windows and Mac OS and never heard of i3wm or py3status but were curious so I showed them. They could read C so I asked them if they could understand how i3status was reading its horrible configuration file&#8230; and they did!</p>



<p>Then Oliver Bestwalter (main maintainer of tox) came and told me he was a long time py3status user&#8230; followed by Hubert Bryłkowski and Ólafur Bjarni! Wow..</p>



<p>We joined forces to create a py3status module that allows the use of the great PewPew hardware device created by Radomir Dopieralski (which was given to all attendees) to control i3!</p>



♦



<p>And we did it and had a lot of fun!</p>









Oliver&#8217;s major contribution



<p>The module itself is awesome okay&#8230; but thanks to Oliver&#8217;s experience with tox he proposed and contributed one of the most significant feature py3status has had: the ability to import modules from other pypi packages!</p>



<p>The idea is that you have your module or set of modules. Instead of having to contribute them to py3status you could just publish them to pypi and py3status will automatically be able to detect and load them!</p>



<p>The usage of entry points allow custom and more distributed modules creation for our project!</p>



<p>Read more about this amazing feature on the docs.</p>



<p>All of this happened during EuroPython 2019 and I want to extend once again my gratitude to everyone who participated!</p>



Thank you contributors



<p>Version 3.20 is also the work of cool contributors.<br>See the changelog.</p>



<ul><li>Daniel Peukert</li><li>Kevin Pulo</li><li>Maxim Baz</li><li>Piotr Miller</li><li>Rodrigo Leite</li><li>lasers</li><li>luto</li></ul>



<p></p>


 <span class='item-time-ago-in-words'>
 4 months ago
 </span>  
  
</div>

</div> <!-- item-body -->
</article><!-- item -->


  



<article class='item'>

<h4 class='feed-title'>
  <span class='feed-title'>
    <a href='http://z-issue.com/wp/'>Nathan Zachary</a>
  </span>
  <span class='item-published'>
     - 
      <!-- fix/todo: show year if not current year
           e.g. use "%b %d, '%y"
         -->
     Sep 06
  </span>
</h4>


<h3 class='item-title'>
  <i class='icon-caret-down item-collapse item-close item-opened'></i>
  <i class='icon-caret-right item-expand item-open item-closed'></i>
  <span class='item-title'>
    <a href='https://z-issue.com/wp/adobe-flash-and-firefox-68-in-gentoo-linux/'>Adobe Flash and Firefox 68+ in Gentoo Linux</a>
   </span>
</h3>

<div class='item-body'>
  
<div class='item-snippet'>
<!-- use 'smarter' algorithm for cutoff snippet text
   note: summary goes first; than try content -->

  Though many sites have abandoned Adobe Flash in favour of HTML5 these days, there are still some legacy applications (e.g. older versions of VMWare&#8217;s vSphere web client) that depend on it. Recent versions of Firefox in Linux (68+) started failing to load Flash content for me, and it took some digging to find out why. &#8230; </p><p>Continue reading


 <span class='item-time-ago-in-words'>
 5 months ago
 </span>  
</div>

<div class='item-content item-summary'>

<!-- todo: use sanitize or simplify or whitelist
   - todo/fix: check why summary can be nil/null
   note: content goes first; than try summary
 -->

  <p>Though many sites have abandoned Adobe Flash in favour of HTML5 these days, there are still some legacy applications (e.g. older versions of VMWare&#8217;s vSphere web client) that depend on it.  Recent versions of Firefox in Linux (68+) started failing to load Flash content for me, and it took some digging to find out why.  First off, I noticed that the content wouldn&#8217;t load even on Adobe&#8217;s Flash test page.  Second off, I found that the plugin wasn&#8217;t listed in Firefox&#8217;s about:plugins page.</p>



<p>So, I realised that the problem was due to the Adobe Flash plugin not integrating properly with Firefox.  I use Gentoo Linux, so these instructions may not directly apply to other distributions, but I would imagine that the directory structures are at least similar.  To start, I made sure that I had installed the www-plugins/adobe-flash ebuild with the &#8216;npapi&#8217; USE flag enabled:</p>



<pre><code>$ eix adobe-flash
[I] www-plugins/adobe-flash
     Available versions:  (22) 32.0.0.238^ms
       {+nsplugin +ppapi ABI_MIPS="n32 n64 o32" ABI_RISCV="lp64 lp64d" ABI_S390="32 64" ABI_X86="32 64 x32"}
     Installed versions:  32.0.0.238(22)^ms(03:13:05 22/08/19)(nsplugin -ppapi ABI_MIPS="-n32 -n64 -o32" ABI_RISCV="-lp64 -lp64d" ABI_S390="-32 -64" ABI_X86="64 -32 -x32")
     Homepage:            www.adobe.com/products/flashplayer.html get.adobe.com/flashplayer/ helpx.adobe.com/security/products/flash-player.html
     Description:         Adobe Flash Player</code></pre>



<p>That ebuild installs the libflashplayer.so (shared object) in the /usr/lib64/nsbrowser/plugins/ directory by default.</p>



<p>However, through some digging, I found that Firefox 68+ was looking in another directory for the plugin (in my particular situation, that directory was /usr/lib64/mozilla/plugins/, which actually didn&#8217;t exist on my system).  Seeing as the target directory didn&#8217;t exist, I had to firstly create it, and then I decided to symlink the shared object there so that future updates to the www-plugins/adobe-flash package would work without any further manual intervention:</p>



<pre><code>mkdir -p /usr/lib64/mozilla/plugins/
cd $_
ln -s /usr/lib64/nsbrowser/plugins/libflashplayer.so .</code></pre>



<p>After restarting Firefox, the Adobe Flash test page started working as did other sites that use Flash.  So, though your particular Linux distribution, version of Firefox, and version of Adobe Flash may require the use of different directories than the ones I referenced above, I hope that these instructions can help you troubleshoot the problem with Adobe Flash not showing in the Firefox about:plugins page.</p>


 <span class='item-time-ago-in-words'>
 5 months ago
 </span>  
  
</div>

</div> <!-- item-body -->
</article><!-- item -->


  



<article class='item'>

<h4 class='feed-title'>
  <span class='feed-title'>
    <a href='http://blogs.gentoo.org/mgorny/'>Michał Górny</a>
  </span>
  <span class='item-published'>
     - 
      <!-- fix/todo: show year if not current year
           e.g. use "%b %d, '%y"
         -->
     Jul 09
  </span>
</h4>


<h3 class='item-title'>
  <i class='icon-caret-down item-collapse item-close item-opened'></i>
  <i class='icon-caret-right item-expand item-open item-closed'></i>
  <span class='item-title'>
    <a href='https://blogs.gentoo.org/mgorny/2019/07/09/verifying-gentoo-election-results-via-votrify/'>Verifying Gentoo election results via Votrify</a>
   </span>
</h3>

<div class='item-body'>
  
<div class='item-snippet'>
<!-- use 'smarter' algorithm for cutoff snippet text
   note: summary goes first; than try content -->

  Gentoo elections are conducted using a&#160;custom software called votify. During the&#160;voting period, the&#160;developers place their votes in&#160;their respective home directories on&#160;one of&#160;the&#160;Gentoo servers. Afterwards, the&#160;election officials collect the&#160;votes, count them, compare their results and&#160;finally announce them. The&#160;simplified description stated a


 <span class='item-time-ago-in-words'>
 7 months ago
 </span>  
</div>

<div class='item-content item-summary'>

<!-- todo: use sanitize or simplify or whitelist
   - todo/fix: check why summary can be nil/null
   note: content goes first; than try summary
 -->

  <p>Gentoo elections are conducted using a&nbsp;custom software called votify.  During the&nbsp;voting period, the&nbsp;developers place their votes in&nbsp;their respective home directories on&nbsp;one of&nbsp;the&nbsp;Gentoo servers.  Afterwards, the&nbsp;election officials collect the&nbsp;votes, count them, compare their results and&nbsp;finally announce them.</p>
<p>The&nbsp;simplified description stated above suggests two weak points.  Firstly, we rely on&nbsp;honesty of&nbsp;election officials.  If they chose to conspire, they could fake the&nbsp;result.  Secondly, we rely on&nbsp;honesty of&nbsp;all Infrastructure members, as&nbsp;they could use root access to&nbsp;manipulate the&nbsp;votes (or&nbsp;the&nbsp;collection process).</p>
<p>To&nbsp;protect against possible fraud, we make the&nbsp;elections transparent (but&nbsp;pseudonymous).  This means that all votes cast are public, so everyone can count them and&nbsp;verify the&nbsp;result.  Furthermore, developers can verify whether their personal vote has been included.  Ideally, all developers would do that and&nbsp;therefore confirm that no votes were manipulated.</p>
<p>Currently, we are pretty much implicitly relying on&nbsp;developers doing that, and&nbsp;assuming that no&nbsp;protest implies successful verification.  However, this is not&nbsp;really reliable, and&nbsp;given the&nbsp;unfriendly nature of&nbsp;our scripts I have reasons to doubt that the&nbsp;majority of&nbsp;developers actually verify the&nbsp;election results.  In&nbsp;this post, I&nbsp;would like to shortly explain how Gentoo elections work, how they could be&nbsp;manipulated and introduce Votrify — a&nbsp;tool to&nbsp;explicitly verify election results.</p>
<p></p>
Gentoo voting process in&nbsp;detail
<p>Once the&nbsp;nomination period is&nbsp;over, an&nbsp;election official sets the&nbsp;voting process up by&nbsp;creating control files for&nbsp;the&nbsp;voting scripts.  Those control files include election name, voting period, ballot (containing all vote choices) and&nbsp;list of&nbsp;eligible voters.</p>
<p>There are no&nbsp;explicit events corresponding to&nbsp;the&nbsp;beginning or&nbsp;the&nbsp;end of&nbsp;voting period.  The&nbsp;votify script used by&nbsp;developers reads election data on&nbsp;each execution, and&nbsp;uses it to determine whether the&nbsp;voting period is open.  During the&nbsp;voting period, it permits the&nbsp;developer to&nbsp;edit the&nbsp;vote, and&nbsp;finally to&nbsp;‘submit’ it.  Both draft and&nbsp;submitted vote are stored as&nbsp;appropriate files in&nbsp;the&nbsp;developer&#8217;s home directory, ‘submitted’ votes are not&nbsp;collected automatically.  This means that the&nbsp;developer can still manually manipulate the&nbsp;vote once voting period concludes, and&nbsp;before the&nbsp;votes are manually collected.</p>
<p>Votes are collected explicitly by&nbsp;an&nbsp;election official.  When run, the&nbsp;countify script collects all vote files from developers&#8217; home directories.  An&nbsp;unique ‘confirmation ID’ is generated for&nbsp;each voting developer.  All votes along with their confirmation IDs are placed in&nbsp;so-called ‘master ballot’, while mapping from developer names to&nbsp;confirmation IDs is stored separately.  The&nbsp;latter is used to send developers their respective confirmation IDs, and&nbsp;can be discarded afterwards.</p>
<p>Each of&nbsp;the&nbsp;election officials uses the&nbsp;master ballot to&nbsp;count the&nbsp;votes.  Afterwards, they compare their results and&nbsp;if they match, they announce the&nbsp;election results.  The&nbsp;master ballot is attached to the&nbsp;announcement mail, so that everyone can verify the&nbsp;results.</p>
Possible manipulations
<p>The&nbsp;three methods of&nbsp;manipulating the&nbsp;vote that I can think of are:</p>
<ol>
<li>Announcing fake results.  An&nbsp;election result may be presented that does not&nbsp;match the&nbsp;votes cast.  This is actively prevented by&nbsp;having multiple election officials, and&nbsp;by&nbsp;making the&nbsp;votes transparent so that everyone can count them.</li>
<li>Manipulating votes cast by&nbsp;developers.  The&nbsp;result could be&nbsp;manipulated by modifying the&nbsp;votes cast by&nbsp;individual developers.  This is prevented by&nbsp;including pseudonymous vote attribution in&nbsp;the&nbsp;master ballot.  Every developer can therefore check whether his/her&nbsp;vote has been reproduced correctly.  However, this presumes that the&nbsp;developer is&nbsp;active.</li>
<li>Adding fake votes to the&nbsp;master ballot.  The&nbsp;result could be&nbsp;manipulated by adding votes that were not cast by&nbsp;any of&nbsp;the&nbsp;existing developers.  This is a&nbsp;major problem, and&nbsp;such manipulation is entirely plausible if&nbsp;the&nbsp;turnout is low enough, and&nbsp;developers who did not vote fail to&nbsp;check whether they have not been added to&nbsp;the&nbsp;casting voter list.</li>
</ol>
<p>Furthermore, the&nbsp;efficiency of&nbsp;the&nbsp;last method can be improved if&nbsp;the&nbsp;attacker is able to restrict communication between voters and/or&nbsp;reliably deliver different versions of&nbsp;the&nbsp;master ballot to&nbsp;different voters, i.e. convince the&nbsp;voters that their own vote was included correctly while manipulating the&nbsp;remaining votes to&nbsp;achieve the&nbsp;desired result.  The&nbsp;former is rather unlikely but the&nbsp;latter is generally feasible.</p>
<p>Finally, the&nbsp;results could be&nbsp;manipulated via&nbsp;manipulating the&nbsp;voting software.  This can be counteracted through verifying the&nbsp;implementation against the&nbsp;algorithm specification or, to&nbsp;some degree, via&nbsp;comparing the&nbsp;results a&nbsp;third party tool.  Robin H. Johnson and&nbsp;myself were historically working on&nbsp;this (or&nbsp;more specifically, on&nbsp;verifying whether the&nbsp;Gentoo implementation of&nbsp;Schulze method is correct) but neither of&nbsp;us was able to finish the&nbsp;work.  If&nbsp;you&#8217;re interested in&nbsp;the&nbsp;topic, you can look at&nbsp;my election-compare repository.  For the&nbsp;purpose of&nbsp;this post, I&#8217;m going to consider this possibility out of&nbsp;scope.</p>
Verifying election results using Votrify
<p>Votrify uses a&nbsp;two-stage verification model.  It consists of&nbsp;individual verification which is performed by&nbsp;each voter separately and&nbsp;produces signed confirmations, and&nbsp;community verification that uses the&nbsp;aforementioned files to&nbsp;provide final verified election result.</p>
<p>The&nbsp;individual verification part involves:</p>
<ol>
<li>Verifying that the&nbsp;developer&#8217;s vote has been recorded correctly.  This takes part in&nbsp;detecting whether any votes have been manipulated.  The&nbsp;positive result of&nbsp;this verification is implied by&nbsp;the&nbsp;fact that a&nbsp;confirmation is produced.  Additionally, developers who did not&nbsp;cast a&nbsp;vote also need to&nbsp;produce confirmations, in&nbsp;order to&nbsp;detect any extraneous votes.</li>
<li>Counting the&nbsp;votes and&nbsp;producing the&nbsp;election result.  This produces the&nbsp;election results as&nbsp;seen from the&nbsp;developer&#8217;s perspective, and&nbsp;therefore prevents manipulation via&nbsp;announcing fake results.  Furthermore, comparing the&nbsp;results between different developers helps finding implementation bugs.</li>
<li>Hashing the&nbsp;master ballot.  The&nbsp;hash of&nbsp;master ballot file is&nbsp;included, and&nbsp;comparing it between different results confirms that all voters received the&nbsp;same master ballot.</li>
</ol>
<p>If&nbsp;the&nbsp;verification is&nbsp;positive, a&nbsp;confirmation is produced and&nbsp;signed using developer&#8217;s OpenPGP key.  I&nbsp;would like to&nbsp;note that no&nbsp;private data is&nbsp;leaked in&nbsp;the&nbsp;process.  It does not even indicate whether the&nbsp;dev in&nbsp;question has actually voted — only that he/she participates in&nbsp;the&nbsp;verification process.</p>
<p>Afterwards, confirmations from&nbsp;different voters are collected.  They are used to&nbsp;perform community verification which involves:</p>
<ol>
<li>Verifying the&nbsp;OpenPGP signature.  This is&nbsp;necessary to&nbsp;confirm the&nbsp;authenticity of&nbsp;the&nbsp;signed confirmation.  The&nbsp;check also involves verifying that the&nbsp;key owner was an&nbsp;eligible voter and&nbsp;that each voter produced only one confirmation.  Therefore, it prevents attempts to~fake the&nbsp;verification results.</li>
<li>Comparing the&nbsp;results and&nbsp;master ballot hashes.  This confirms that everyone participating received the&nbsp;same master ballot, and&nbsp;produced the&nbsp;same results.</li>
</ol>
<p>If&nbsp;the&nbsp;verification for&nbsp;all confirmations is&nbsp;positive, the&nbsp;election results are repeated, along with explicit quantification of&nbsp;how trustworthy they are.  The&nbsp;number indicates how many confirmations were used, and&nbsp;therefore how many of&nbsp;the&nbsp;votes (or&nbsp;non-votes) in&nbsp;master ballot were confirmed.  The&nbsp;difference between the&nbsp;number of&nbsp;eligible voters and&nbsp;the&nbsp;number of&nbsp;confirmations indicates how many votes may have been altered, planted or&nbsp;deleted.  Ideally, if&nbsp;all eligible voters produced signed confirmations, the&nbsp;election would be 100%&nbsp;confirmed.</p>


 <span class='item-time-ago-in-words'>
 7 months ago
 </span>  
  
</div>

</div> <!-- item-body -->
</article><!-- item -->


  



<article class='item'>

<h4 class='feed-title'>
  <span class='feed-title'>
    <a href='http://blogs.gentoo.org/mgorny/'>Michał Górny</a>
  </span>
  <span class='item-published'>
     - 
      <!-- fix/todo: show year if not current year
           e.g. use "%b %d, '%y"
         -->
     Jul 04
  </span>
</h4>


<h3 class='item-title'>
  <i class='icon-caret-down item-collapse item-close item-opened'></i>
  <i class='icon-caret-right item-expand item-open item-closed'></i>
  <span class='item-title'>
    <a href='https://blogs.gentoo.org/mgorny/2019/07/04/sks-poisoning-keys-openpgp-org-hagrid-and-other-non-solutions/'>SKS poisoning, keys.openpgp.org / Hagrid and other non-solutions</a>
   </span>
</h3>

<div class='item-body'>
  
<div class='item-snippet'>
<!-- use 'smarter' algorithm for cutoff snippet text
   note: summary goes first; than try content -->

  The&#160;recent key poisoning attack on&#160;SKS keyservers shook the&#160;world of&#160;OpenPGP. While this isn&#8217;t a&#160;new problem, it has not been exploited on&#160;this scale before. The&#160;attackers have proved how easy it is to poison commonly used keys on&#160;the&#160;keyservers and&#160;effectively render GnuPG unusably slow. A&#160;renewed discussion on&#160;improving keyservers 


 <span class='item-time-ago-in-words'>
 7 months ago
 </span>  
</div>

<div class='item-content item-summary'>

<!-- todo: use sanitize or simplify or whitelist
   - todo/fix: check why summary can be nil/null
   note: content goes first; than try summary
 -->

  <p>The&nbsp;recent key poisoning attack on&nbsp;SKS keyservers shook the&nbsp;world of&nbsp;OpenPGP.  While this isn&#8217;t a&nbsp;new problem, it has not been exploited on&nbsp;this scale before.  The&nbsp;attackers have proved how easy it is to poison commonly used keys on&nbsp;the&nbsp;keyservers and&nbsp;effectively render GnuPG unusably slow.  A&nbsp;renewed discussion on&nbsp;improving keyservers has started as&nbsp;a&nbsp;result.  It also forced Gentoo to&nbsp;employ countermeasures.  You can read more on them in&nbsp;the&nbsp;‘Impact of SKS keyserver poisoning on Gentoo’ news item.</p>
<p>Coincidentally, the&nbsp;attack happened shortly after the&nbsp;launch of&nbsp;keys.openpgp.org, that advertises itself as&nbsp;both poisoning-resistant and&nbsp;GDPR-friendly keyserver.  Naturally, many users see it as&nbsp;the&nbsp;ultimate solution to the&nbsp;issues with&nbsp;SKS.  I&#8217;m afraid I have to&nbsp;disagree — in&nbsp;my opinion, this keyserver does not solve any problems, it merely cripples OpenPGP in&nbsp;order to&nbsp;avoid being affected by&nbsp;them, and&nbsp;harms its security in&nbsp;the&nbsp;process.</p>
<p>In&nbsp;this article, I&#8217;d like to&nbsp;shortly explain what the&nbsp;problem is, and&nbsp;which of&nbsp;the&nbsp;different solutions proposed so far to it (e.g. on&nbsp;gnupg-users mailing list) make sense, and&nbsp;which make things even worse.  Naturally, I will also cover the&nbsp;new Hagrid keyserver as&nbsp;one of&nbsp;the&nbsp;glorified non-solutions.</p>
<p></p>
The&nbsp;attack — key poisoning
<p>OpenPGP uses a&nbsp;distributed design — once the&nbsp;primary key is created, additional packets can be freely appended to it and&nbsp;recombined on&nbsp;different systems.  Those packets include subkeys, user identifiers and&nbsp;signatures.  Signatures are used to confirm the&nbsp;authenticity of&nbsp;appended packets.  The&nbsp;packets are only meaningful if&nbsp;the&nbsp;client can verify the&nbsp;authenticity of&nbsp;their respective signatures.</p>
<p>The&nbsp;attack is carried through third-party signatures that normally are used by&nbsp;different people to&nbsp;confirm the&nbsp;authenticity of&nbsp;the&nbsp;key — that is, to&nbsp;state that the&nbsp;signer has verified the&nbsp;identity of&nbsp;the&nbsp;key owner.  It relies on&nbsp;three distinct properties of&nbsp;OpenPGP:</p>
<ol>
<li>The&nbsp;key can contain unlimited number of signatures.  After all, it is natural that very old keys will have a&nbsp;large number of signatures made by&nbsp;different people on&nbsp;them.</li>
<li>Anyone can append signatures to any OpenPGP key.  This is partially keyserver policy, and&nbsp;partially the&nbsp;fact that SKS keyserver nodes are propagating keys one to&nbsp;another.</li>
<li>There is no way to&nbsp;distinguish legitimate signatures from garbage.  To put it other way, it is trivial to&nbsp;make garbage signatures look like the&nbsp;real deal.</li>
</ol>
<p>The&nbsp;attacker abuses those properties by&nbsp;creating a&nbsp;large number of&nbsp;garbage signatures and&nbsp;sending them to&nbsp;keyservers.  When users fetch key updates from&nbsp;the&nbsp;keyserver, GnuPG normally appends all those signatures to the&nbsp;local copy.  As&nbsp;a&nbsp;result, the&nbsp;key becomes unusually large and&nbsp;causes severe performance issues with GnuPG, preventing its normal usage.  The&nbsp;user ends up having to manually remove the&nbsp;key in&nbsp;order to fix the&nbsp;installation.</p>
The&nbsp;obvious non-solutions and&nbsp;potential solutions
<p>Let&#8217;s start by analyzing the&nbsp;properties I&#8217;ve listed above.  After all, removing at&nbsp;least one of&nbsp;the&nbsp;requirements should prevent the&nbsp;attack from being possible.  But can we really do that?</p>
<p>Firstly, we could set a&nbsp;hard limit on&nbsp;number of&nbsp;signatures or&nbsp;key size.  This should obviously prevent the&nbsp;attacker from breaking user systems via&nbsp;huge keys.  However, it will make it entirely possible for the&nbsp;attacker to&nbsp;‘brick’ the&nbsp;key by&nbsp;appending garbage up to the&nbsp;limit.  Then it would no longer be&nbsp;possible to append any valid signatures to the&nbsp;key.  Users would suffer less but the&nbsp;key owner will lose the&nbsp;ability to&nbsp;use the&nbsp;key meaningfully.  It&#8217;s a&nbsp;no-go.</p>
<p>Secondly, we could limit key updates to the&nbsp;owner.  However, the&nbsp;keyserver update protocol currently does not provide any standard way of&nbsp;verifying who the&nbsp;uploader is, so it would effectively require incompatible changes at&nbsp;least to the&nbsp;upload protocol.  Furthermore, in&nbsp;order to&nbsp;prevent malicious keyservers from propagating fake signatures we&#8217;d also need to carry the&nbsp;verification along when propagating key updates.  This effectively means an&nbsp;extension of&nbsp;the&nbsp;key format, and&nbsp;it has been proposed e.g. in&nbsp;‘Abuse-Resistant OpenPGP Keystores’ draft.  This is probably a&nbsp;wortwhile option but it will take time before it&#8217;s implemented.</p>
<p>Thirdly, we could try to&nbsp;validate signatures.  However, any validation can be easily worked around.  If we started requiring signing keys to be&nbsp;present on&nbsp;the&nbsp;keyserver, the&nbsp;attackers can simply mass-upload keys used to&nbsp;create garbage signatures.  If we went even further and&nbsp;e.g.&nbsp;started requiring verified e-mail addresses for the&nbsp;signing keys, the&nbsp;attackers can simply mass-create e-mail addresses and&nbsp;verify them.  It might work as&nbsp;a&nbsp;temporary solution but it will probably cause more harm than good.</p>
<p>There were other non-solutions suggested — most notably, blacklisting poisoned keys.  However, this is even worse.  It means that every victim of&nbsp;poisoning attack would be excluded from using the&nbsp;keyserver, and&nbsp;in&nbsp;my opinion it will only provoke the&nbsp;attackers to&nbsp;poison even more keys.  It may sound like a&nbsp;good interim solution preventing users from being hit but it is rather short-sighted.</p>
keys.openpgp.org / Hagrid — a&nbsp;big non-solution
<p>A&nbsp;common suggestion for&nbsp;OpenPGP users — one that even Gentoo news item mentions for lack of&nbsp;alternative — is to switch to&nbsp;keys.openpgp.org keyserver, or&nbsp;switch keyservers to their Hagrid software.  It is not vulnerable to key poisoning attack because it strips away all third-party signatures.  However, this and&nbsp;other limitations make it a&nbsp;rather poor replacement, and&nbsp;in&nbsp;my opinion can be harmful to&nbsp;security of&nbsp;OpenPGP.</p>
<p>Firstly, stripping all third-party signatures is not a&nbsp;solution.  It simply avoids the&nbsp;problem by&nbsp;killing a&nbsp;very important portion of&nbsp;OpenPGP protocol — the&nbsp;Web of&nbsp;Trust.  Without it, the&nbsp;keys obtained from the&nbsp;server can not be authenticated otherwise than by&nbsp;direct interaction between the&nbsp;individuals.  For example, Gentoo Authority Keys can&#8217;t work there.  Most of&nbsp;the&nbsp;time, you won&#8217;t be able to&nbsp;tell whether the&nbsp;key on&nbsp;keyserver is legitimate or&nbsp;forged.</p>
<p>The&nbsp;e-mail verification makes it even worse, though not intentionally.  While I agree that many users do not understand or&nbsp;use WoT, Hagrid is implicitly going to&nbsp;cause users to start relying on&nbsp;e-mail verification as&nbsp;proof of&nbsp;key authenticity.  In&nbsp;other words, people are going to assume that if a&nbsp;key on&nbsp;keys.openpgp.org has verified e-mail address, it has to be&nbsp;legitimate.  This makes it trivial for an&nbsp;attacker that manages to&nbsp;gain unauthorized access to the&nbsp;e-mail address or&nbsp;the&nbsp;keyserver to&nbsp;publish a&nbsp;forged key and&nbsp;convince others to use it.</p>
<p>Secondly, Hagrid does not support UID revocations.  This is an&nbsp;entirely absurd case where GDPR fear won over security.  If&nbsp;your e-mail address becomes compromised, you will not be able to&nbsp;revoke it.  Sure, the&nbsp;keyserver admins may eventually stop propagating it along with your key, but all users who fetched the&nbsp;key before will continue seeing it as&nbsp;a&nbsp;valid UID.  Of&nbsp;course, if&nbsp;users send encrypted mail the&nbsp;attacker won&#8217;t be able to&nbsp;read it.  However, the&nbsp;users can be trivially persuaded to&nbsp;switch to a&nbsp;new, forged key.</p>
<p>Thirdly, Hagrid rejects all UIDs except for verified e-mail-based UIDs.  This is something we could live with if&nbsp;key owners actively pursue having their identities verified.  However, this also means you can&#8217;t publish a&nbsp;photo identity or&nbsp;use keybase.io.  The&nbsp;‘explicit consent’ argument used by&nbsp;upstream is&nbsp;rather silly — apparently every UID requires separate consent, while at&nbsp;the&nbsp;same time you can trivially share somebody else&#8217;s PII as&nbsp;the&nbsp;real name of&nbsp;a&nbsp;valid e-mail address.</p>
<p>Apparently, upstream is willing to&nbsp;resolve the&nbsp;first two of&nbsp;those issues once satisfactory solutions are established.  However, this doesn&#8217;t mean that it&#8217;s fine to&nbsp;ignore those problems.  Until they are resolved, and&nbsp;necessary OpenPGP client updates are sufficiently widely deployed, I don&#8217;t believe Hagrid or&nbsp;its instance at&nbsp;keys.openpgp.org are good replacements for&nbsp;SKS and&nbsp;other keyservers.</p>
So what are the&nbsp;solutions?
<p>Sadly, I am not aware of&nbsp;any good global solution at&nbsp;the&nbsp;moment.  The&nbsp;best workaround for&nbsp;GnuPG users so far is the&nbsp;new self-sigs-only option that prevents it from importing third-party signatures.  Of course, it shares the&nbsp;first limitation of&nbsp;Hagrid keyserver.  The future versions of&nbsp;GnuPG will supposedly fallback to this option upon meeting excessively large keys.</p>
<p>For&nbsp;domain-limited use cases such as&nbsp;Gentoo&#8217;s, running a&nbsp;local keyserver with restricted upload access is an&nbsp;option.  However, it requires users to&nbsp;explicitly specify our keyserver, and&nbsp;effectively end up having to&nbsp;specify multiple different keyservers for&nbsp;each domain.  Furthermore, WKD can be&nbsp;used to&nbsp;distribute keys.  Sadly, at&nbsp;the&nbsp;moment GnuPG uses it only to&nbsp;locate new keys and&nbsp;does not support refreshing keys via WKD (gemato employs a&nbsp;cheap hack to&nbsp;make it happen).  In&nbsp;both cases, the&nbsp;attack is&nbsp;prevented via&nbsp;isolating the&nbsp;infrastructure and&nbsp;preventing public upload access.</p>
<p>The&nbsp;long-term solution probably lies in&nbsp;the&nbsp;‘First-party-attested Third-party Certifications‘ section of the&nbsp;‘Abuse-Resistant OpenPGP Keystores’ draft.  In&nbsp;this proposal, every third-party signature must be explicitly attested by the&nbsp;key owner.  Therefore, only the&nbsp;key owner can append additional signatures to&nbsp;the&nbsp;key, and&nbsp;keyservers can reject any signatures that were not attested.  However, this is not currently supported by&nbsp;GnuPG, and&nbsp;once it is, deploying it will most likely take significant time.</p>


 <span class='item-time-ago-in-words'>
 7 months ago
 </span>  
  
</div>

</div> <!-- item-body -->
</article><!-- item -->


  



<article class='item'>

<h4 class='feed-title'>
  <span class='feed-title'>
    <a href='http://www.gentoo.org/rdf/en/gentoo-news.rdf'>Gentoo News</a>
  </span>
  <span class='item-published'>
     - 
      <!-- fix/todo: show year if not current year
           e.g. use "%b %d, '%y"
         -->
     Jul 03
  </span>
</h4>


<h3 class='item-title'>
  <i class='icon-caret-down item-collapse item-close item-opened'></i>
  <i class='icon-caret-right item-expand item-open item-closed'></i>
  <span class='item-title'>
    <a href='https://www.gentoo.org/news/2019/07/03/sks-key-poisoning.html'>Impact of SKS keyserver poisoning on Gentoo</a>
   </span>
</h3>

<div class='item-body'>
  
<div class='item-snippet'>
<!-- use 'smarter' algorithm for cutoff snippet text
   note: summary goes first; than try content -->

  <p>The SKS keyserver network has been a victim of certificate poisoning
attack
lately.  The OpenPGP verification used for repository syncing is protected
against the attack.  However, our users can be affected when using GnuPG
directly.  In this post, we would like to shortly summarize what the attack is,
what we did to protect Gentoo against it and what can you do to protect your
system.</p>

<!--


 <span class='item-time-ago-in-words'>
 7 months ago
 </span>  
</div>

<div class='item-content item-summary'>

<!-- todo: use sanitize or simplify or whitelist
   - todo/fix: check why summary can be nil/null
   note: content goes first; than try summary
 -->

  <p>The SKS keyserver network has been a victim of certificate poisoning
attack
lately.  The OpenPGP verification used for repository syncing is protected
against the attack.  However, our users can be affected when using GnuPG
directly.  In this post, we would like to shortly summarize what the attack is,
what we did to protect Gentoo against it and what can you do to protect your
system.</p>

<!--more-->

<p>The certificate poisoning attack abuses three facts: that OpenPGP keys can
contain unlimited number of signatures, that anyone can append signatures
to any key and that there is no way to distinguish a legitimate signature
from garbage.  The attackers are appending a large number of garbage signatures
to keys stored on SKS keyservers, causing them to become very large and cause
severe performance issues in GnuPG clients that fetch them.</p>

<p>The attackers have poisoned the keys of a few high ranking OpenPGP people
on the SKS keyservers, including one Gentoo developer.  Furthermore, the
current expectation is that the problem won’t be fixed any time soon, so it
seems plausible that more keys may be affected in the future.  We recommend
users not to fetch or refresh keys from SKS keyserver network (this includes
aliases such as <code>keys.gnupg.net</code>) for the time being.  GnuPG upstream is
already working on client-side countermeasures and they can be expected to
enter Gentoo as soon as they are released.</p>

<p>The Gentoo key infrastructure has not been affected by the attack.  Shortly
after it was reported, we have disabled fetching developer key updates from SKS
and today we have disabled public key upload access to prevent the keys stored
on the server from being poisoned by a malicious third party.</p>

<p>The gemato tool used to verify the Gentoo ebuild repository uses
WKD by default. During normal operation it should
not be affected by this vulnerability. Gemato has a keyserver fallback that
might be vulnerable if WKD fails, however gemato operates in an isolated
environment that will prevent a poisoned key from causing permanent damage to
your system. In the worst case; Gentoo repository syncs will be slow or hang.</p>

<p>The webrsync and delta-webrsync methods also support gemato, although it is
not used by default at the moment.  In order to use it, you need to remove
<code>PORTAGE_GPG_DIR</code> from <code>/etc/portage/make.conf</code> (if it present) and put
the following values into <code>/etc/portage/repos.conf</code>:</p>

<pre><code>[gentoo]
sync-type = webrsync
sync-webrsync-delta = true  # false to use plain webrsync
sync-webrsync-verify-signature = true
</code></pre>

<p>Afterwards, calling <code>emerge --sync</code> or <code>emaint sync --repo gentoo</code> will use
gemato key management rather than the vulnerable legacy method.  The default is
going to be changed in a future release of Portage.</p>

<p>When using GnuPG directly, Gentoo developer and service keys can
be securely fetched (and refreshed) via:</p>

<ol>
  <li>Web Key Directory, e.g. <code>gpg --locate-key developer@gentoo.org</code></li>
  <li>Gentoo keyserver,
e.g. <code>gpg --keyserver hkps://keys.gentoo.org ...</code></li>
  <li>Key bundles, e.g.:
active devs,
service keys</li>
</ol>

<p>Please note that the aforementioned services provide only keys specific
to Gentoo.  Keys belonging to other people will not be found on our keyserver.
If you are looking for them, you may try keys.openpgp.org keyserver that is not vulnerable to the attack,
at the cost of stripping all signatures and unverified UIDs.</p>


 <span class='item-time-ago-in-words'>
 7 months ago
 </span>  
  
</div>

</div> <!-- item-body -->
</article><!-- item -->


  



<article class='item'>

<h4 class='feed-title'>
  <span class='feed-title'>
    <a href='https://mthode.org/'>Matthew Thode</a>
  </span>
  <span class='item-published'>
     - 
      <!-- fix/todo: show year if not current year
           e.g. use "%b %d, '%y"
         -->
     Apr 24
  </span>
</h4>


<h3 class='item-title'>
  <i class='icon-caret-down item-collapse item-close item-opened'></i>
  <i class='icon-caret-right item-expand item-open item-closed'></i>
  <span class='item-title'>
    <a href='http://blog.mthode.org/posts/2019/Apr/building-gentoo-disk-images/'>Building Gentoo disk images</a>
   </span>
</h3>

<div class='item-body'>
  
<div class='item-snippet'>
<!-- use 'smarter' algorithm for cutoff snippet text
   note: summary goes first; than try content -->

  Disclaimer
<p>I'm not responsible if you ruin your system, this guide functions as documentation for future me.  Remember to back up your data.</p>
Why this is useful / needed
<p>It's useful to have a way of building a disk image for shipping, either for testing or production usage.  The image output formats could be qcow2, raw or compressed tarball, it's up to you to make this what you want it to 


 <span class='item-time-ago-in-words'>
 9 months ago
 </span>  
</div>

<div class='item-content item-summary'>

<!-- todo: use sanitize or simplify or whitelist
   - todo/fix: check why summary can be nil/null
   note: content goes first; than try summary
 -->

  Disclaimer
<p>I'm not responsible if you ruin your system, this guide functions as documentation for future me.  Remember to back up your data.</p>
Why this is useful / needed
<p>It's useful to have a way of building a disk image for shipping, either for testing or production usage.  The image output formats could be qcow2, raw or compressed tarball, it's up to you to make this what you want it to be.</p>
Pre-work
<p>Install diskimage-builder, for Gentoo you just have to 'emerge' the latest version.  I personally keep one around in a virtual environment for testing (this allows me to build musl images as well easily).</p>
The actual setup
<p>What diskimage-builder actually does is take elements and run them. Each elements consists of a set of phases where the element takes actions.  All you are really doing is defining the elements and they will insert themselves where needed.
It also uses environment variables for tunables, or for other various small tweaks.</p>
<p>This is how I build the images at distfiles.gentoo.org/experimental/amd64/openstack/</p>
<pre>export GENTOO_PORTAGE_CLEANUP=True
export DIB_INSTALLTYPE_pip_and_virtualenv=package
export DIB_INSTALLTYPE_simple_init=repo
export GENTOO_PYTHON_TARGETS=&quot;python3_6&quot;
export GENTOO_PYTHON_ACTIVE_VERSION=&quot;python3.6&quot;
export ELEMENTS=&quot;gentoo simple-init growroot vm openssh-server block-device-mbr&quot;
export COMMAND=&quot;disk-image-create -a amd64 -t qcow2 --image-size 3&quot;
export DATE=&quot;$(date -u +%Y%m%d)&quot;

GENTOO_PROFILE=default/linux/amd64/17.0/no-multilib/hardened ${COMMAND} -o &quot;gentoo-openstack-amd64-hardened-nomultilib-${DATE}&quot; ${ELEMENTS}
GENTOO_PROFILE=default/linux/amd64/17.0/no-multilib ${COMMAND} -o &quot;gentoo-openstack-amd64-default-nomultilib-${DATE}&quot; ${ELEMENTS}
GENTOO_PROFILE=default/linux/amd64/17.0/hardened ${COMMAND} -o &quot;gentoo-openstack-amd64-hardened-${DATE}&quot; ${ELEMENTS}
GENTOO_PROFILE=default/linux/amd64/17.0/systemd ${COMMAND} -o &quot;gentoo-openstack-amd64-systemd-${DATE}&quot; ${ELEMENTS}
${COMMAND} -o &quot;gentoo-openstack-amd64-default-${DATE}&quot; ${ELEMENTS}
</pre>


<p>For musl I've had to do some custom work as I have to build the stage4s locally, but it's largely the same (with the additional need to define a musl overlay.</p>
<pre>cd ~/diskimage-builder
cp ~/10-gentoo-image.musl diskimage_builder/elements/gentoo/root.d/10-gentoo-image
pip install -U .
cd ~/

export GENTOO_PORTAGE_CLEANUP=False
export DIB_INSTALLTYPE_pip_and_virtualenv=package
export DIB_INSTALLTYPE_simple_init=repo
export GENTOO_PYTHON_TARGETS=&quot;python3_6&quot;
export GENTOO_PYTHON_ACTIVE_VERSION=&quot;python3.6&quot;
DATE=&quot;$(date +%Y%m%d)&quot;
export GENTOO_OVERLAYS=&quot;musl&quot;
export GENTOO_PROFILE=default/linux/amd64/17.0/musl/hardened

disk-image-create -a amd64 -t qcow2 --image-size 3 -o gentoo-openstack-amd64-hardened-musl-&quot;${DATE}&quot; gentoo simple-init growroot vm

cd ~/diskimage-builder
git checkout diskimage_builder/elements/gentoo/root.d/10-gentoo-image
pip install -U .
cd ~/
</pre>


Generic images
<p>The elements I use are for an OpenStack image, meaning there is no default user/pass, those are set by cloud-init / glean.  For a generic image you will want the following elements.</p>
<p>'gentoo growroot devuser vm'</p>
<p>The following environment variables are needed as well (changed to match your needs).</p>
<p>DIB_DEV_USER_PASSWORD=supersecrete DIB_DEV_USER_USERNAME=secrete DIB_DEV_USER_PWDLESS_SUDO=yes DIB_DEV_USER_AUTHORIZED_KEYS=/foo/bar/.ssh/authorized_keys</p>
Fin
<p>All this work was done upstream, if you have a question (or feature request) just ask.  I'm on irc (Freenode) as prometheanfire or the same nick at gentoo.org for email.</p>


 <span class='item-time-ago-in-words'>
 9 months ago
 </span>  
  
</div>

</div> <!-- item-body -->
</article><!-- item -->


  



<article class='item'>

<h4 class='feed-title'>
  <span class='feed-title'>
    <a href='http://www.ultrabug.fr/'>Alexys Jacob</a>
  </span>
  <span class='item-published'>
     - 
      <!-- fix/todo: show year if not current year
           e.g. use "%b %d, '%y"
         -->
     Mar 29
  </span>
</h4>


<h3 class='item-title'>
  <i class='icon-caret-down item-collapse item-close item-opened'></i>
  <i class='icon-caret-right item-expand item-open item-closed'></i>
  <span class='item-title'>
    <a href='https://www.ultrabug.fr/scylla-four-ways-to-optimize-your-disk-space-consumption/'>Scylla: four ways to optimize your disk space consumption</a>
   </span>
</h3>

<div class='item-body'>
  
<div class='item-snippet'>
<!-- use 'smarter' algorithm for cutoff snippet text
   note: summary goes first; than try content -->

  We recently had to face free disk space outages on some of our scylla clusters and we learnt some very interesting things while outlining some improvements that could be made to the ScyllaDB guys. 100% disk space usage? First of all I wanted to give a bit of a heads up about what happened when [&#8230;]


 <span class='item-time-ago-in-words'>
 10 months ago
 </span>  
</div>

<div class='item-content item-summary'>

<!-- todo: use sanitize or simplify or whitelist
   - todo/fix: check why summary can be nil/null
   note: content goes first; than try summary
 -->

  <p>We recently had to face free disk space outages on some of our scylla clusters and we learnt some very interesting things while outlining some improvements that could be made to the ScyllaDB guys.</p>



♦



100% disk space usage?



<p>First of all I wanted to give a bit of a heads up about what happened when some of our scylla nodes reached (almost) 100% disk space usage.</p>



<p>Basically they:</p>



<ul><li>stopped listening to client requests</li><li>complained in the logs</li><li>wouldn&#8217;t flush commitlog (expected)</li><li>abort their compaction work (which actually gave back a few GB of space)</li><li>stay in a stuck / unable to stop state (unexpected, this has been reported)</li></ul>



<p>After restarting your scylla server, the first and obvious thing you can try to do to get out of this situation is to run the nodetool clearsnapshot command which will remove any data snapshot that could be lying around. That&#8217;s a handy command to reclaim space usually.</p>



<p>Reminder: depending on your compaction strategy, it is usually not advised to allow your data to grow over 50% of disk space...</p>



<p>But that&#8217;s only a patch so let&#8217;s go down the rabbit hole and look at the optimization options we have.</p>







Optimize your schemas



<p>Schema design and the types your choose for your columns have a huge impact on disk space usage! And in our case we indeed overlooked some of the optimizations that we could have done from the start and that did cost us a lot of wasted disk space. Fortunately it was easy and fast to change.</p>



<p>To illustrate this, I&#8217;ll take a sample of 100,000 rows of a simple and naive schema associating readings of 50 integers to a user ID:</p>



<p>Note: all those operations were done using Scylla 3.0.3 on Gentoo Linux.</p>



<pre>CREATE TABLE IF NOT EXISTS test.not_optimized<br>(<br>    uid text,<br>    readings list&lt;int&gt;,<br>    PRIMARY KEY(uid)<br>) WITH compression = {};</pre>



<p>Once inserted on disk, this takes about 250MB of disk space:</p>



<pre>250M    not_optimized-00cf1500520b11e9ae38000000000004</pre>



<p>Now depending on your use case, if those readings at not meant to be updated for example you could use a frozen list instead, which will allow a huge storage optimization:</p>



<pre>CREATE TABLE IF NOT EXISTS test.mid_optimized<br> (<br>     uid text,<br>     readings frozen&lt;list&lt;int&gt;&gt;,<br>     PRIMARY KEY(uid)<br> ) WITH compression = {};</pre>



<p>With this frozen list we now consume 54MB of disk space for the same data!</p>



<pre>54M     mid_optimized-011bae60520b11e9ae38000000000004</pre>



<p>There&#8217;s another optimization that we could do since our user ID are UUIDs. Let&#8217;s switch to the uuid type instead of text:</p>



<pre>CREATE TABLE IF NOT EXISTS test.optimized<br> (<br>     uid uuid,<br>     readings frozen&lt;list&lt;int&gt;&gt;,<br>     PRIMARY KEY(uid)<br> ) WITH compression = {};</pre>



<p>By switching to uuid, we now consume 50MB of disk space: that&#8217;s a 80% reduced disk space consumption compared to the naive schema for the same data!</p>



<pre>50M     optimized-01f74150520b11e9ae38000000000004</pre>



Enable compression



<p>All those examples were not using compression. If your workload latencies allows it, you should probably enable compression on your sstables.</p>



<p>Let&#8217;s see its impact on our tables:</p>



<pre>ALTER TABLE test.not_optimized WITH compression = {'sstable_compression': 'org.apache.cassandra.io.compress.LZ4Compressor'};<br>ALTER TABLE test.mid_optimized WITH compression = {'sstable_compression': 'org.apache.cassandra.io.compress.LZ4Compressor'};<br>ALTER TABLE test.optimized WITH compression = {'sstable_compression': 'org.apache.cassandra.io.compress.LZ4Compressor'};</pre>



<p>Then we run a nodetool compact test to force a (re)compaction of all the sstables and we get:</p>



<pre>63M     not_optimized-00cf1500520b11e9ae38000000000004<br>28M     mid_optimized-011bae60520b11e9ae38000000000004<br>24M     optimized-01f74150520b11e9ae38000000000004</pre>



<p>Compression is really a great gain here allowing another 50% reduced disk space usage reduction on our optimized table!</p>



Switch to the new &#8220;mc&#8221; sstable format



<p>Since the Scylla 3.0 release you can use the latest &#8220;mc&#8221; sstable storage format on your scylla clusters. It promises a greater efficiency for usually a way more reduced disk space consumption!</p>



<p>It is not enabled by default, you have to add the enable_sstables_mc_format: true parameter to your scylla.yaml for it to be taken into account.</p>



<p>Since it&#8217;s backward compatible, you have nothing else to do as new compactions will start being made using the &#8220;mc&#8221; storage format and the scylla server will seamlessly read from old sstables as well.</p>



<p>But in our case of immediate disk space outage, we switched to the new format one node at a time, dropped the data from it and ran a nodetool rebuild to reconstruct the whole node using the new sstable format.</p>



<p>Let&#8217;s demonstrate its impact on our test tables: we add the option to the scylla.yaml file, restart scylla-server and run nodetool compact test again:</p>



<pre>49M     not_optimized-00cf1500520b11e9ae38000000000004<br>26M     mid_optimized-011bae60520b11e9ae38000000000004<br>22M     optimized-01f74150520b11e9ae38000000000004</pre>



<p>That&#8217;s a pretty cool gain of disk space, even more for the not optimized version of our schema!</p>



<p>So if you&#8217;re in great need of disk space or it is hard for you to change your schemas, switching to the new &#8220;mc&#8221; sstable format is a simple and efficient way to free up some space without effort.</p>



Consider using secondary indexes



<p>While denormalization is the norm (yep.. legitimate pun) in the NoSQL world this does not mean we have to duplicate everything all the time. A good example lies in the internals of secondary indexes if your workload can compromise with its moderate impact on latency.</p>



<p>Secondary indexes on scylla are built on top of Materialized Views that basically stores an up to date pointer from your indexed column to your main table partition key. That means that secondary indexes MVs are not duplicating all the columns (and thus the data) from your main table as you would have to do when denormalizing a table to query by another column: this saves disk space!</p>



<p>This of course comes with a latency drawback because if your workload is interested in the other columns than the partition key of the main table, the coordinator node will actually issue two queries to get all your data:</p>



<ol><li>query the secondary index MV to get the pointer to the partition key of the main table</li><li>query the main table with the partition key to get the rest of the columns you asked for</li></ol>



<p>This has been an effective trick to avoid duplicating a table and save disk space for some of our workloads!</p>



(not a tip) Move the commitlog to another disk / partition?



<p>This should only be considered as a sort of emergency procedure or for cost efficiency (cheap disk tiering) on non critical clusters.</p>



<p>While this is possible even if the disk is not formatted using XFS, it not advised to separate the commitlog from data on modern SSD/NVMe disks but&#8230; you technically can do it (as we did) on non production clusters.</p>



<p>Switching is simple, you just need to change the commitlog_directory parameter in your scylla.yaml file.</p>


 <span class='item-time-ago-in-words'>
 10 months ago
 </span>  
  
</div>

</div> <!-- item-body -->
</article><!-- item -->


  



<article class='item'>

<h4 class='feed-title'>
  <span class='feed-title'>
    <a href='http://blogs.gentoo.org/leio/'>Mart Raudsepp</a>
  </span>
  <span class='item-published'>
     - 
      <!-- fix/todo: show year if not current year
           e.g. use "%b %d, '%y"
         -->
     Mar 26
  </span>
</h4>


<h3 class='item-title'>
  <i class='icon-caret-down item-collapse item-close item-opened'></i>
  <i class='icon-caret-right item-expand item-open item-closed'></i>
  <span class='item-title'>
    <a href='https://blogs.gentoo.org/leio/2019/03/26/gnome-3-30/#utm_source=feed&utm_medium=feed&utm_campaign=feed'>Gentoo GNOME 3.30 for all init systems</a>
   </span>
</h3>

<div class='item-body'>
  
<div class='item-snippet'>
<!-- use 'smarter' algorithm for cutoff snippet text
   note: summary goes first; than try content -->

  GNOME 3.30 is now available in Gentoo Linux testing branch. Starting with this release, GNOME on Gentoo once again works with OpenRC, in addition to the usual systemd option. This is achieved through the elogind project, a standalone logind implementation based on systemd code, which is currently maintained by a fellow Gentoo user. It provides &#8230; Continue reading Gentoo GNOME 3.30 for all init


 <span class='item-time-ago-in-words'>
 10 months ago
 </span>  
</div>

<div class='item-content item-summary'>

<!-- todo: use sanitize or simplify or whitelist
   - todo/fix: check why summary can be nil/null
   note: content goes first; than try summary
 -->

  <p>GNOME 3.30 is now available in Gentoo Linux testing branch.<br>
Starting with this release, GNOME on Gentoo once again works with OpenRC, in addition to the usual systemd option. This is achieved through the elogind project, a standalone logind implementation based on systemd code, which is currently maintained by a fellow Gentoo user. It provides the missing logind interfaces currently required by GNOME without booting with systemd.</p>
<p>For easier GNOME install, the desktop/gnome profiles now set up default USE flags with elogind for OpenRC systems, while the desktop/gnome/systemd profiles continue to do that for systemd systems. Both have been updated to provide a better initial GNOME install experience. After profile selection, a full install should be simply a matter of `emerge gnome` for testing branch users. Don&#8217;t forget to adapt your system to any changed USE flags on previously installed packages too.</p>
<p>GNOME 3.32 is expected to be made available in testing branch soon as well, followed by introducing all this for stable branch users. This is hoped to complete within 6-8 weeks.</p>
<p>If you encounter issues, don&#8217;t hesitate to file bug reports or, if necessary, contact me via e-mail or IRC. You can also discuss the elogind aspects on the Gentoo Forums.</p>
Acknowledgements
<p>I&#8217;d like to thank Gavin Ferris, for kindly agreeing to sponsor my work on the above (upgrading GNOME on Gentoo from 3.26 to 3.30 and introducing Gentoo GNOME elogind support); and dantrell, for his pioneering overlay work integrating GNOME 3 with OpenRC on Gentoo, and also the GNOME and elogind projects.</p>


 <span class='item-time-ago-in-words'>
 10 months ago
 </span>  
  
</div>

</div> <!-- item-body -->
</article><!-- item -->


  <!-- each item (inside column) -->
 </td>

<!-- each column-->
  </tr>
</table>

</body>
</html>
